<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=generator content="Wowchemy 5.3.0 for Hugo">
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap">
<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" media=print onload="this.media='all'">
<meta name=description content="How to develop an end-user application using network communications.">
<link rel=alternate hreflang=en-us href=https://keyple.org/learn/user-guide/distributed-application/>
<meta name=theme-color content="#1D87BB">
<link rel=stylesheet href=../../../css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css media=print onload="this.media='all'">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin=anonymous media=print onload="this.media='all'">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/darcula.min.css crossorigin=anonymous title=hl-light media=print onload="this.media='all'">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/darcula.min.css crossorigin=anonymous title=hl-dark media=print onload="this.media='all'" disabled>
<link rel=stylesheet href=../../../css/wowchemy.92d0ccb04abeab7ab99253bf3b3b540b.css>
<script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({'gtm.start':(new Date).getTime(),event:'gtm.js'});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!='dataLayer'?'&l='+a:'';c.async=!0,c.src='https://www.googletagmanager.com/gtm.js?id='+g+h,f.parentNode.insertBefore(c,f)})(window,document,'script','dataLayer','GTM-5WLCZXC')</script>
<link rel=manifest href=../../../manifest.webmanifest>
<link rel=icon type=image/png href=../../../media/icon_hu16db34b3636b127457de39ca2fab620f_9845_32x32_fill_lanczos_center_3.png>
<link rel=apple-touch-icon type=image/png href=../../../media/icon_hu16db34b3636b127457de39ca2fab620f_9845_180x180_fill_lanczos_center_3.png>
<link rel=canonical href=https://keyple.org/learn/user-guide/distributed-application/>
<meta property="twitter:card" content="summary">
<meta property="og:site_name" content="Eclipse Keyple">
<meta property="og:url" content="https://keyple.org/learn/user-guide/distributed-application/">
<meta property="og:title" content="Distributed Application User Guide | Eclipse Keyple">
<meta property="og:description" content="How to develop an end-user application using network communications."><meta property="og:image" content="https://keyple.org/media/logo.svg">
<meta property="twitter:image" content="https://keyple.org/media/logo.svg"><meta property="og:locale" content="en-us">
<meta property="article:modified_time" content="2022-07-26T16:25:33+02:00">
<title>Distributed Application User Guide | Eclipse Keyple</title>
</head>
<body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=8a904b9f9936e7ea56be3cfe5bc9e243>
<script src=../../../js/wowchemy-init.min.da42964e270e05a6063fbca894d7ccff.js></script>
<aside class=search-modal id=search>
<div class=container>
<section class=search-header>
<div class="row no-gutters justify-content-between mb-3">
<div class=col-6>
<h1>Search</h1>
</div>
<div class="col-6 col-search-close">
<a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a>
</div>
</div>
<div id=search-box>
<input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...>
</div>
</section>
<section class=section-search-results>
<div id=search-hits>
</div>
</section>
</div>
</aside>
<div class=page-header>
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main>
<div class=container-xl>
<div class="d-none d-lg-inline-flex">
<a class=navbar-brand href=../../../><img src=../../../media/logo.svg alt="Eclipse Keyple"></a>
</div>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span>
</button>
<div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
<a class=navbar-brand href=../../../><img src=../../../media/logo.svg alt="Eclipse Keyple"></a>
</div>
<div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content>
<ul class="navbar-nav d-md-inline-flex">
<li class="nav-item dropdown">
<a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>What is Eclipse Keyple®</span><span class=caret></span>
</a>
<div class=dropdown-menu>
<a class=dropdown-item href=../../../what-is-keyple/overview/><span>Overview</span></a>
<a class=dropdown-item href=../../../what-is-keyple/why-trust/><span>Why trust Eclipse Keyple®?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/who-is-it-for/><span>Who is it for?</span></a>
<a class=dropdown-item href=../../../#adopters><span>Who is using Eclipse Keyple®?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/what-is-calypso/><span>What is Calypso®?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/main-features/><span>Keyple's main features</span></a>
<a class=dropdown-item href=../../../#news><span>News</span></a>
</div>
</li>
<li class=nav-item>
<a class=nav-link href=../../../learn/overview><span>Learn</span></a>
</li>
<li class="nav-item dropdown">
<a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>Components</span><span class=caret></span>
</a>
<div class=dropdown-menu>
<a class=dropdown-item href=../../../components-java/overview/><span>Java implementation v2+</span></a>
<a class=dropdown-item href=../../../components-cpp/overview/><span>C++ implementation v2+</span></a>
<a class=dropdown-item href=../../../><span> </span></a>
<a class=dropdown-item href=../../../learn/user-guide/migrate-to-2-0><span>Guide to migrate from v1.0 to v2+</span></a>
<a class=dropdown-item href=../../../components-java-1.0/><span>Java implementation v1.0 (deprecated)</span></a>
<a class=dropdown-item href=../../../components-cpp-0.9/><span>C++ implementation v0.9 (deprecated)</span></a>
</div>
</li>
<li class="nav-item dropdown">
<a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>Community</span><span class=caret></span>
</a>
<div class=dropdown-menu>
<a class=dropdown-item href=../../../community/contributing/><span>Contributing</span></a>
<a class=dropdown-item href=../../../community/roadmap/><span>Roadmap</span></a>
<a class=dropdown-item href=../../../community/changelog/><span>Changelog</span></a>
<a class=dropdown-item href=../../../project-dashboard/><span>Project dashboard</span></a>
<a class=dropdown-item href="https://sonarcloud.io/organizations/eclipse/projects?search=keyple&sort=-analysis_date"><span>Code quality dashboard</span></a>
<a class=dropdown-item href=https://projects.eclipse.org/projects/iot.keyple/><span>Eclipse Foundation Keyple page</span></a>
<a class=dropdown-item href=https://accounts.eclipse.org/mailing-list/keyple-dev/><span>Mailing list</span></a>
<a class=dropdown-item href=https://github.com/eclipse/keyple/><span>GitHub home repository</span></a>
</div>
</li>
<li class="nav-item dropdown">
<a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>External resources</span><span class=caret></span>
</a>
<div class=dropdown-menu>
<a class=dropdown-item href=../../../external-resources/external-add-ons/><span>External add-ons</span></a>
<a class=dropdown-item href=../../../external-resources/compliant-terminals/><span>Compliant terminals</span></a>
<a class=dropdown-item href=../../../external-resources/support-and-training-companies/><span>Support & training companies</span></a>
</div>
</li>
</ul>
</div>
<ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
<li class=nav-item>
<a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a>
</li>
</ul>
</div>
</nav>
</div>
<div class=page-body>
<div class="container-fluid docs">
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 docs-sidebar">
<form class="docs-search d-flex align-items-center">
<button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<div class=d-flex>
<span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
User guides
</span>
<span><i class="fas fa-chevron-down"></i></span>
</div>
</button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>Search...</span>
<span class=sidebar-search-shortcut>/</span>
</button>
</form>
<nav class="collapse docs-links" id=docs-nav>
<ul class="nav docs-sidenav">
<li><a href=../../../learn/></a></li>
<div class=docs-toc-item>
<a class=docs-toc-link href=../../../learn/overview/>Overview</a>
<ul class="nav docs-sidenav">
<li><a href=../../../learn/overview/key-concepts/>Key concepts</a></li>
<li><a href=../../../learn/overview/architecture/>Architecture</a></li>
<li><a href=../../../learn/overview/terminalapis/>Calypso Terminal APIs</a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=../../../learn/build-your-first-app/>Build your first app</a>
<ul class="nav docs-sidenav">
<li><a href=../../../learn/build-your-first-app/java-app/>Java</a></li>
<li><a href=../../../learn/build-your-first-app/android-app/>Android</a></li>
<li><a href=../../../learn/build-your-first-app/cpp-app/>C++</a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=../../../learn/user-guide/>User guides</a>
<ul class="nav docs-sidenav">
<li><a href=../../../learn/user-guide/standalone-application/>Standalone application</a></li>
<li class=active><a href=../../../learn/user-guide/distributed-application/>Distributed application</a></li>
<li><a href=../../../learn/user-guide/distributed-json-api-1-0/>Distributed JSON API 1.0</a></li>
<li><a href=../../../learn/user-guide/calypso-application/>Calypso application</a></li>
<li><a href=../../../learn/user-guide/card-resource-service/>Card resource service</a></li>
<li><a href=../../../learn/user-guide/migrate-to-2-0/>Upgrade Keyple</a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=../../../learn/developer-guide/>Developer guides</a>
<ul class="nav docs-sidenav">
<li><a href=../../../learn/developer-guide/reader-plugin-add-on/>Reader plugin add-on</a></li>
<li><a href=../../../learn/developer-guide/card-extension-add-on/>Card extension add-on</a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=../../../learn/example-code/>Example code</a>
<ul class="nav docs-sidenav">
<li><a href=../../../learn/example-code/java-example/>Java examples</a></li>
<li><a href=../../../learn/example-code/cpp-example/>C++ examples</a></li>
</ul>
</div>
<div class=docs-toc-item>
<a class=docs-toc-link href=../../../learn/keyple-in-depth/>Keyple in depth</a>
<ul class="nav docs-sidenav">
<li><a href=../../../learn/keyple-in-depth/core-services/>Core services</a></li>
<li><a href=../../../learn/keyple-in-depth/calypso-card-extension/>Calypso card extension</a></li>
<li><a href=../../../learn/keyple-in-depth/build-and-ci/>Build and CI</a></li>
</ul>
</div>
</ul>
</nav>
</div>
<div class="d-none d-xl-block col-xl-2 docs-toc">
<ul class="nav toc-top">
<li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li>
</ul>
<nav id=TableOfContents>
<ul>
<li><a href=#overview>Overview</a></li>
<li><a href=#how-to-use-it>How to use it</a></li>
<li><a href=#concepts>Concepts</a></li>
<li><a href=#usage-modes>Usage modes</a>
<ul>
<li><a href=#reader-client-side>Reader Client Side</a></li>
<li><a href=#reader-server-side>Reader Server Side</a></li>
</ul>
</li>
<li><a href=#network-configuration>Network configuration</a>
<ul>
<li><a href=#synchronous>Synchronous</a></li>
<li><a href=#asynchronous>Asynchronous</a></li>
<li><a href=#exchanged-data>Exchanged data</a></li>
</ul>
</li>
<li><a href=#api>API</a></li>
<li><a href=#examples>Examples</a></li>
<li><a href=#download>Download</a></li>
</ul>
</nav>
</div>
<main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main>
<article class=article>
<div class=docs-article-container>
<h1>Distributed Application User Guide</h1>
<div class=article-style>
<hr>
<h2 id=overview>Overview</h2>
<p>Keyple provides the &ldquo;Keyple Distributed&rdquo; solution which allows a terminal to communicate with a smart card reader available in another terminal.</p>
<p>In this way, you can manage transactions within a distributed architecture.</p>
<p>The diagram below shows the location of the Keyple Distributed components in the software layers used in a distributed architecture:</p>
<figure id=figure-keyple-distributed---solution-layers-overview>
<div class="d-flex justify-content-center">
<div class=w-100><img src=../../../media/learn/user-guide/distributed-application/distributed_solution_layers_overview.svg alt="Keyple Distributed - Solution layers overview" loading=lazy data-zoomable></div>
</div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>
Keyple Distributed - Solution layers overview
</figcaption></figure>
<hr>
<h2 id=how-to-use-it>How to use it</h2>
<ol>
<li>In pre-requisite, read <a href=../../../learn/user-guide/standalone-application/>Standalone Application User Guide</a> to understand the main concepts of Keyple in a standalone application.</li>
<li>Learn <a href=#concepts>main terms and concepts</a> of the Keyple Distributed solution.</li>
<li>Find your <a href=#usage-modes>usage mode</a>. This will help you to determine exactly which library and API to use.</li>
<li><a href=#download>Import</a> into your project the libraries specified by your usage mode.</li>
<li>Implement the transport layer adapted to your <a href=#network-configuration>network configuration</a>.</li>
<li>Implement your ticketing services as specified in the associated usage mode.</li>
</ol>
<hr>
<h2 id=concepts>Concepts</h2>
<p>Here are the main concepts to keep in mind before continuing to read this user guide:</p>
<div id=concepts-table-1>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Remote Lib</strong></td>
<td>This is the <code>keyple-distributed-remote-java-lib</code> library.<br>It must be imported and used by the application installed on the terminal not having local access to the smart card reader and that wishes to control the reader remotely.</td>
</tr>
<tr>
<td><strong>Local Lib</strong></td>
<td>This is the <code>keyple-distributed-local-java-lib</code> library.<br>It must be imported and used by the application installed on the terminal having local access to the smart card reader but wishes to delegate all or part of the ticketing processing to a remote application.</td>
</tr>
<tr>
<td><strong>Network Lib</strong></td>
<td>This is the <code>keyple-distributed-network-java-lib</code> library.<br>It must always be imported because it contains the network elements used by <strong>Remote Lib</strong> and <strong>Local Lib</strong>.</td>
</tr>
<tr>
<td><strong>Remote Plugin</strong></td>
<td>Part of the <strong>Remote Lib</strong>, this is a Keyple reader plugin extension which provides only <strong>Remote Readers</strong> to the application. It manages data exchanges with the <strong>Local Service</strong>. This reader plugin extension must be registered to the smart card service like any Keyple reader plugin.</td>
</tr>
<tr>
<td><strong>Remote Reader</strong></td>
<td>Part of the <strong>Remote Lib</strong>, this is a Keyple reader extension which has some specificities:<br>- each remote reader is connected to a local reader;<br>- any command sent by the application to a remote reader will be forwarded to the associated local reader;<br>- in some cases only, an event occurring on a local reader or plugin will be automatically forwarded to the associated remote reader or plugin.</td>
</tr>
<tr>
<td><strong>Local Service</strong></td>
<td>Part of the <strong>Local Lib</strong>, this is a Keyple distributed local service extension which ensures data exchange between the <strong>Remote Plugin</strong> and local plugins and readers. It must be registered to the smart card service.</td>
</tr>
<tr>
<td><strong>Factory</strong></td>
<td><strong>Remote Plugin</strong> and <strong>Local Service</strong> each have a specific factory class to initialize them.</td>
</tr>
<tr>
<td><strong>Node</strong></td>
<td><strong>Remote Plugin</strong> and <strong>Local Service</strong> each are bind to a specific internal node which is responsible for the interfacing with the <strong>Network Endpoint</strong>.</td>
</tr>
<tr>
<td><strong>Network Endpoint</strong></td>
<td>At the user&rsquo;s charge, this component ensures the network exchanges between the <strong>Remote Plugin</strong> and <strong>Local Service</strong> nodes.</td>
</tr>
</tbody>
</table>
</div>
<style>#concepts-table-1 table th:first-of-type{width:130px}</style>
<p>The diagram below illustrates the main functional concepts through a standard use case:</p>
<figure id=figure-keyple-distributed---concepts---main-use-case>
<div class="d-flex justify-content-center">
<div class=w-100><img src=../../../media/learn/user-guide/distributed-application/distributed_concepts_1.svg alt="Keyple Distributed - Concepts - Main use case" loading=lazy data-zoomable></div>
</div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>
Keyple Distributed - Concepts - Main use case
</figcaption></figure>
<p>The second diagram below illustrates an arbitrary more complex possible use case with several hardware readers connected to different terminals.</p>
<p>These could be for example a ticketing reloading service, where the business logic would be on the terminal without local readers, with thin clients on A & B terminals communicating locally with the cards.</p>
<p>In this use case, the Keyple Distributed solution is use for card communication.</p>
<figure id=figure-keyple-distributed---concepts---one-remote-plugin-connected-to-many-local-services>
<div class="d-flex justify-content-center">
<div class=w-100><img src=../../../media/learn/user-guide/distributed-application/distributed_concepts_2.svg alt="Keyple Distributed - Concepts - One remote plugin connected to many local services" loading=lazy data-zoomable></div>
</div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>
Keyple Distributed - Concepts - One remote plugin connected to many local services
</figcaption></figure>
<p>Here is another example, but this time it illustrates several remote plugins connected to the same local service.</p>
<p>These could be for example ticketing terminals with transaction logic, which communicate locally with cards, but which do not have SAM, and which use a SAM server with hardware reader.</p>
<p>In this use case, the Keyple Distributed solution is use for SAM communication.</p>
<figure id=figure-keyple-distributed---concepts---many-remote-plugins-connected-to-one-local-service>
<div class="d-flex justify-content-center">
<div class=w-100><img src=../../../media/learn/user-guide/distributed-application/distributed_concepts_3.svg alt="Keyple Distributed - Concepts - Many remote plugins connected to one local service" loading=lazy data-zoomable></div>
</div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>
Keyple Distributed - Concepts - Many remote plugins connected to one local service
</figcaption></figure>
<hr>
<h2 id=usage-modes>Usage modes</h2>
<p>The Keyple Distributed solution offers two different usage modes, each one having a specific API designed on a <strong>Client-Server</strong> model:</p>
<div id=plugins-table-1>
<table>
<thead>
<tr>
<th>Usage mode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=#reader-client-side>Reader Client Side</a></td>
<td>Allows a <strong>server</strong> application to control a smart card reader available on a <strong>client</strong> (e.g. Card reader).</td>
</tr>
<tr>
<td><a href=#reader-server-side>Reader Server Side</a></td>
<td>Allows a <strong>client</strong> application to control a smart card reader available on a <strong>server</strong> (e.g. SAM reader, HSM).</td>
</tr>
</tbody>
</table>
</div>
<style>#plugins-table-1 table th:first-of-type{width:190px}</style>
<p>Each mode provides a different <strong>Remote Plugin</strong> and <strong>Local Service</strong> and their associated factories.</p>
<p>In an application, it is possible to use simultaneously several usage modes and as many instances of a usage mode as you want, as long as the components are initialized with different names.</p>
<h3 id=reader-client-side>Reader Client Side</h3>
<p>This usage mode allows a <strong>server</strong> application to control a smart card reader available on a <strong>client</strong> (e.g. Card reader).</p>
<p>In this mode, the client is the initiator of the application processing following the local plugin or reader events (reader connection/disconnection or card insertion/removal).</p>
<p>He can hand over to the server whenever he wants to perform a remote ticketing service on a card present in one of his local readers.</p>
<p>The table below shows the classes and interfaces available for this usage mode.<br>
Interfaces marked with an asterisk &ldquo;*&rdquo; come from the <strong>Calypsonet Terminal Reader API</strong>.<br>
Interfaces marked with an asterisk &ldquo;**&rdquo; come from the <strong>Keyple Service API</strong>:</p>
<table>
<thead>
<tr>
<th>API</th>
<th>Client</th>
<th>Server</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Library to use</strong></td>
<td>Local Lib</td>
<td>Remote Lib</td>
</tr>
<tr>
<td><strong>Factory builder to be used</strong></td>
<td><code>LocalServiceClientFactoryBuilder</code></td>
<td><code>RemotePluginServerFactoryBuilder</code></td>
</tr>
<tr>
<td><strong>Factory to be registered</strong></td>
<td><code>LocalServiceClientFactory</code></td>
<td><code>RemotePluginServerFactory</code></td>
</tr>
<tr>
<td><strong>Local Service / Remote Plugin</strong></td>
<td><code>DistributedLocalService</code> **</td>
<td><code>ObservablePlugin</code> **</td>
</tr>
<tr>
<td><strong>Local Service / Remote Plugin extension</strong></td>
<td><code>LocalServiceClient</code></td>
<td><code>RemotePluginServer</code></td>
</tr>
<tr>
<td><strong>Reader</strong></td>
<td>Any kind of reader</td>
<td><code>CardReader</code> *</td>
</tr>
<tr>
<td><strong>Reader extension</strong></td>
<td>Device specific</td>
<td><code>RemoteReaderServer</code></td>
</tr>
</tbody>
</table>
<div class="alert alert-warning">
<div>
It is the responsibility of the client application to observe and configure the local plugins and readers.
</div>
</div>
<h4 id=operating-mode>OPERATING MODE</h4>
<ul>
<li><strong>Server</strong>
<ol>
<li>Build an instance of the <code>RemotePluginServerFactory</code> using the <code>RemotePluginServerFactoryBuilder</code> class, specifying a unique name for the <strong>Remote Plugin</strong> to be registered and your network endpoint implementation if required.</li>
<li>Register the <strong>Remote Plugin</strong> to the smart card service by providing the previously built factory.</li>
<li>Cast the registered plugin into an <code>ObservablePlugin</code> and add an event observer to it.<br><div class="alert alert-note"><div>Please note that this remote plugin is observable only to trigger ticketing services on the server side, but does not allow observation on the local plugin such as reader connection or disconnection.</div></div></li>
<li>Await for events of type <code>PluginEvent.Type.READER_CONNECTED</code>.<br><div class="alert alert-note"><div>This type of event indicates to the server that a client asks it to perform a specific ticketing service using the connected remote reader.</div></div></li>
<li>When an event occurs, you must retrieve the connected remote reader from the registered plugin using the name of the reader contained in the event.<br><div class="alert alert-note"><div>Please note that the remote reader is strictly an instance of <code>CardReader</code>, even if the local reader is an <code>ObservableCardReader</code>.<br>This usage mode does not allow to observe reader events such as card insertion or removal from the server.<br>It is the responsibility of the client to observe the local reader if needed, then to ask the server to execute a specific remote service depending on the case.</div></div></li>
<li>Use information inside the <code>RemoteReaderServer</code> extension of the remote reader to identify the ticketing service to execute.</li>
<li>Execute the specified ticketing service using the remote reader and all of its other information.</li>
<li>End the remote ticketing service by invoking the associated method provided by the <code>RemotePluginServer</code> extension of the remote plugin.<br>It is then possible to send additional information to the client if necessary.</li>
</ol>
</li>
<li><strong>Client</strong>
<ol>
<li>Build an instance of the <code>LocalServiceClientFactory</code> using the <code>LocalServiceClientFactoryBuilder</code> class, specifying a unique name for the <strong>Local Service</strong> to be registered and your network endpoint implementation.</li>
<li>Register the <strong>Local Service</strong> to the smart card service by providing the previously built factory.</li>
<li>Register at least a local plugin to the smart card service and get the name of the local reader to connect to the server.</li>
<li>Execute the desired remote service by invoking the associated method provided by the <code>LocalServiceClient</code> extension of the local service by specifying the identifier of the ticketing service to be executed, the name of the target local reader, and transmitting to the server if necessary the contents of the previously read smart card or additional information.</li>
</ol>
</li>
</ul>
<h3 id=reader-server-side>Reader Server Side</h3>
<p>This usage mode allows a <strong>client</strong> application to control a smart card reader or a pool of smart card readers available on a <strong>server</strong> (e.g. SAM reader, HSM).</p>
<p>The Keyple Distributed solution offers for this usage mode a remote control of all types of plugins (<code>Plugin</code>, <code>ObservablePlugin</code>, <code>PoolPlugin</code>):</p>
<ul>
<li><strong>Regular plugin</strong> (<code>Plugin</code> or <code>ObservablePlugin</code>)</li>
</ul>
<p>During the remote plugin registration process, the client automatically creates a remote reader for each local reader of the set of local plugins on the server.</p>
<p>If the factory has been properly configured, then the remote plugin and reader behave like the local plugins and readers.</p>
<p>It is then possible to observe directly from the client the plugin and/or reader events (reader connection/disconnection or card insertion/removal) if desired.</p>
<p>The table below shows the classes and interfaces available for this usage mode in the case of a <strong>regular plugin</strong>.<br>
Interfaces marked with an asterisk &ldquo;*&rdquo; come from the <strong>Calypsonet Terminal Reader API</strong>.<br>
Interfaces marked with an asterisk &ldquo;**&rdquo; come from the <strong>Keyple Service API</strong>:</p>
<table>
<thead>
<tr>
<th>API</th>
<th>Client</th>
<th>Server</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Library to use</strong></td>
<td>Remote Lib</td>
<td>Local Lib</td>
</tr>
<tr>
<td><strong>Factory builder to be used</strong></td>
<td><code>RemotePluginClientFactoryBuilder</code></td>
<td><code>LocalServiceServerFactoryBuilder</code></td>
</tr>
<tr>
<td><strong>Factory to be registered</strong></td>
<td><code>RemotePluginClientFactory</code></td>
<td><code>LocalServiceServerFactory</code></td>
</tr>
<tr>
<td><strong>Remote Plugin / Local Service</strong></td>
<td><code>Plugin</code> ** or<br><code>ObservablePlugin</code> **</td>
<td><code>DistributedLocalService</code> **</td>
</tr>
<tr>
<td><strong>Remote Plugin / Local Service extension</strong></td>
<td><code>RemotePluginClient</code></td>
<td><code>LocalServiceServer</code></td>
</tr>
<tr>
<td><strong>Reader</strong></td>
<td><code>CardReader</code> * or<br><code>ObservableCardReader</code> *</td>
<td>Any kind of reader</td>
</tr>
<tr>
<td><strong>Reader extension</strong></td>
<td><code>RemoteReaderClient</code></td>
<td>Device specific</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Pool plugin</strong> (<code>PoolPlugin</code>)</li>
</ul>
<p>The dynamic reader allocation process will search for the first available reader among all or a subset of the pool plugins registered on the server.</p>
<p>It is possible to define during the configuration phase of the local service factory a filter on the names of the pool plugins to use.</p>
<p>The table below shows the classes and interfaces available for this usage mode in the case of a <strong>pool plugin</strong>.<br>
Interfaces marked with an asterisk &ldquo;*&rdquo; come from the <strong>Calypsonet Terminal Reader API</strong>.<br>
Interfaces marked with an asterisk &ldquo;**&rdquo; come from the <strong>Keyple Service API</strong>:</p>
<table>
<thead>
<tr>
<th>API</th>
<th>Client</th>
<th>Server</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Library to use</strong></td>
<td>Remote Lib</td>
<td>Local Lib</td>
</tr>
<tr>
<td><strong>Factory builder to be used</strong></td>
<td><code>RemotePoolPluginClientFactoryBuilder</code></td>
<td><code>LocalServiceServerFactoryBuilder</code></td>
</tr>
<tr>
<td><strong>Factory to be registered</strong></td>
<td><code>RemotePluginClientFactory</code></td>
<td><code>LocalServiceServerFactory</code></td>
</tr>
<tr>
<td><strong>Remote Plugin / Local Service</strong></td>
<td><code>PoolPlugin</code> **</td>
<td><code>DistributedLocalService</code> **</td>
</tr>
<tr>
<td><strong>Remote Plugin / Local Service extension</strong></td>
<td><code>RemotePluginClient</code></td>
<td><code>LocalServiceServer</code></td>
</tr>
<tr>
<td><strong>Reader</strong></td>
<td><code>CardReader</code> *</td>
<td>Any kind of reader</td>
</tr>
<tr>
<td><strong>Reader extension</strong></td>
<td><code>RemoteReaderClient</code></td>
<td>Device specific</td>
</tr>
</tbody>
</table>
<div class="alert alert-warning">
<div>
Whatever the type of plugin, it is the responsibility of the server application to configure the local plugins and readers.
</div>
</div>
<h4 id=operating-mode-1>OPERATING MODE</h4>
<ul>
<li><strong>Server</strong>
<ol>
<li>Build an instance of the <code>LocalServiceServerFactory</code> using the <code>LocalServiceServerFactoryBuilder</code> class, specifying a unique name for the <strong>Local Service</strong> to be registered and your network endpoint implementation if required.</li>
<li>Register the <strong>Local Service</strong> to the smart card service by providing the previously built factory.</li>
<li>Register at least a local plugin or pool plugin to the smart card service, depending on your case.</li>
</ol>
</li>
<li><strong>Client</strong>
<ol>
<li>Build an instance of the <code>RemotePluginClientFactory</code> using the <code>RemotePluginClientFactoryBuilder</code> or <code>RemotePoolPluginClientFactoryBuilder</code> class depends on the type of plugin that you want to manage, specifying a unique name for the <strong>Remote Plugin</strong> to be registered and your network endpoint implementation.</li>
<li>Register the <strong>Remote Plugin</strong> to the smart card service by providing the previously built factory.</li>
<li>Use the registered remote plugin as a local plugin.</li>
</ol>
</li>
</ul>
<hr>
<h2 id=network-configuration>Network configuration</h2>
<p>The Keyple Distributed solution <strong>does not provide</strong> the network layer implementation, but it provides a set of SPIs (Service Provider Interfaces) to be implemented by the user in order to enable it to exchange data between <strong>Remote Plugin</strong> and <strong>Local Service</strong> components.</p>
<h3 id=synchronous>Synchronous</h3>
<p>Choose this mode if you want to implement a Client-Server <strong>synchronous</strong> communication protocol, such as standard HTTP for example.</p>
<table>
<thead>
<tr>
<th></th>
<th>Client</th>
<th>Server</th>
</tr>
</thead>
<tbody>
<tr>
<td>Network endpoint SPI to be implemented</td>
<td><code>SyncEndpointClientSpi</code></td>
<td>-</td>
</tr>
<tr>
<td>Node API</td>
<td><code>SyncNodeClient</code></td>
<td><code>SyncNodeServer</code></td>
</tr>
<tr>
<td>Method to be used when initializing the factory</td>
<td><code>withSyncNode(...)</code></td>
<td><code>withSyncNode()</code></td>
</tr>
<tr>
<td>Method provided by the remote plugin or local service extension<br>to use to access the node</td>
<td>-</td>
<td><code>getSyncNode()</code></td>
</tr>
</tbody>
</table>
<p>Here is the minimal algorithm to implement in a context with a <strong>single server instance</strong>:</p>
<figure id=figure-keyple-distributed---synchronous-network-implementation>
<div class="d-flex justify-content-center">
<div class=w-100><img src=../../../media/learn/user-guide/distributed-application/distributed_synchronous.svg alt="Keyple Distributed - Synchronous network implementation" loading=lazy data-zoomable></div>
</div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>
Keyple Distributed - Synchronous network implementation
</figcaption></figure>
<p>In a context with several server instances, a mechanism must be implemented to ensure that all messages containing information about a <code>serverNodeId</code> are routed to the server associated with a <code>SyncNodeServer</code> node having the <code>serverNodeId</code>.</p>
<h3 id=asynchronous>Asynchronous</h3>
<p>Choose this mode if you want to implement a Full-Duplex <strong>asynchronous</strong> communication protocol, such as Web Sockets for example.</p>
<table>
<thead>
<tr>
<th></th>
<th>Client</th>
<th>Server</th>
</tr>
</thead>
<tbody>
<tr>
<td>Network endpoint SPI to be implemented</td>
<td><code>AsyncEndpointClientSpi</code></td>
<td><code>AsyncEndpointServerSpi</code></td>
</tr>
<tr>
<td>Node API</td>
<td><code>AsyncNodeClient</code></td>
<td><code>AsyncNodeServer</code></td>
</tr>
<tr>
<td>Method to be used when initializing the factory</td>
<td><code>withAsyncNode(...)</code></td>
<td><code>withAsyncNode(...)</code></td>
</tr>
<tr>
<td>Method provided by the remote plugin or local service extension<br>to use to access the node</td>
<td><code>getAsyncNode()</code></td>
<td><code>getAsyncNode()</code></td>
</tr>
</tbody>
</table>
<p>Here is the minimal algorithm to implement:</p>
<figure id=figure-keyple-distributed---asynchronous-network-implementation>
<div class="d-flex justify-content-center">
<div class=w-100><img src=../../../media/learn/user-guide/distributed-application/distributed_asynchronous.svg alt="Keyple Distributed - Asynchronous network implementation" loading=lazy data-zoomable></div>
</div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>
Keyple Distributed - Asynchronous network implementation
</figcaption></figure>
<h3 id=exchanged-data>Exchanged data</h3>
<p>The data exchanged between <strong>Remote Plugin</strong> and <strong>Local Service</strong> components are contained in the DTO (Data Transfer Object) <code>MessageDto</code>. It is built and processed by the plugin and <strong>you don&rsquo;t need to modify it</strong>.</p>
<p>However, it is necessary in some contexts to access certain information such as the <code>sessionId</code> in the case of asynchronous communication or the <code>serverNodeId</code> in the case of synchronous communication with several server instances.</p>
<hr>
<h2 id=api>API</h2>
<ul>
<li><a href=https://eclipse.github.io/keyple-distributed-local-java-lib target=_blank rel=noopener>Local API</a></li>
<li><a href=https://eclipse.github.io/keyple-distributed-network-java-lib target=_blank rel=noopener>Network API</a></li>
<li><a href=https://eclipse.github.io/keyple-distributed-remote-java-lib target=_blank rel=noopener>Remote API</a></li>
</ul>
<hr>
<h2 id=examples>Examples</h2>
<ul>
<li><a href=https://github.com/eclipse/keyple-java-example target=_blank rel=noopener>Java examples</a></li>
</ul>
<hr>
<h2 id=download>Download</h2>
<ul>
<li><a href=https://keyple.org/components-java/overview/configuration-wizard/>Java components</a></li>
</ul>
</div>
<div class=article-widget>
<div class=post-nav>
<div class=post-nav-item>
<div class=meta-nav>Previous</div>
<a href=../../../learn/user-guide/standalone-application/ rel=next>Standalone Application User Guide</a>
</div>
<div class=post-nav-item>
<div class=meta-nav>Next</div>
<a href=../../../learn/user-guide/distributed-json-api-1-0/ rel=prev>Distributed JSON API 1.0 User Guide</a>
</div>
</div>
</div>
</div>
<div class=body-footer>
<p>Last updated on 2022-07-26</p>
</div>
</article>
<footer class=site-footer>
<div class=container>
<div class="row featurette">
<div class="col-12 col-sm-4">
<p style=color:#fff><b>ECLIPSE LEGAL</b></p>
<a href=https://www.eclipse.org/legal/privacy.php>Privacy Policy</a><br>
<a href=https://www.eclipse.org/legal/termsofuse.php>Terms of Use</a><br>
<a href=https://www.eclipse.org/legal/copyright.php>Copyright Agent</a><br>
<a href=https://www.eclipse.org/legal/epl-2.0/>Eclipse Public License</a><br>
<a href=https://www.eclipse.org/legal/>Legal Resources</a><br>
<a href=https://eclipse.org/security/ target=_blank>Report a Vulnerability</a><br>
</div>
<div class="col-12 col-sm-4">
<a href=https://www.eclipse.org target=_blank>
<img src=../../../media/eclipse_foundation_logo.svg id=logo-eclipse-foundation>
</a>
</div>
<div class="col-12 col-sm-4">
<a href=https://iot.eclipse.org target=_blank>
<img src=../../../media/eclipse_iot_logo.svg id=logo-eclipse-iot>
</a>
</div>
</div>
</div>
<p class=powered-by id=copyright>
© 2020-2023 The Eclipse Keyple® project. All Rights Reserved.
</p>
<p class=powered-by id=template-info>
Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.
</p>
</footer>
</main>
</div>
</div>
</div>
<div class=page-footer>
</div>
<div id=modal class="modal fade" role=dialog>
<div class=modal-dialog>
<div class=modal-content>
<div class=modal-header>
<h5 class=modal-title>Cite</h5>
<button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span>
</button>
</div>
<div class=modal-body>
<pre><code class="tex hljs"></code></pre>
</div>
<div class=modal-footer>
<a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank>
<i class="fas fa-copy"></i> Copy
</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank>
<i class="fas fa-download"></i> Download
</a>
<div id=modal-error></div>
</div>
</div>
</div>
</div>
<script src=../../../js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/java.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/groovy.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/xml.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/kotlin.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/cpp.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/gradle.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/ini.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/make.min.js crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script>
<script id=search-hit-fuse-template type=text/x-template>
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script>
<script src=../../../en/js/wowchemy.min.8414c33d590e497d63ce70adeefc8179.js></script>
<link rel=stylesheet href=https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap4.min.css>
<script src=https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js></script>
<script src=https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js></script>
</body>
</html>