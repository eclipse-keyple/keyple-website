<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 5.9.6"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=../../../css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=../../../css/wowchemy.2f9263fc44a928b033d7ab8a9897bd56.css><link rel=stylesheet href=../../../css/libs/chroma/github-dark.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=../../../css/libs/chroma/github-dark.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=description content="How to develop an end-user standalone application."><link rel=alternate hreflang=en-us href=https://keyple.org/learn/user-guide/standalone-application/><link rel=canonical href=https://keyple.org/learn/user-guide/standalone-application/><link rel=manifest href=../../../manifest.webmanifest><link rel=icon type=image/png href=../../../media/icon_hu16db34b3636b127457de39ca2fab620f_9845_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=../../../media/icon_hu16db34b3636b127457de39ca2fab620f_9845_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1D87BB"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://keyple.org/media/logo.svg"><meta property="og:type" content="article"><meta property="og:site_name" content="Eclipse Keyple"><meta property="og:url" content="https://keyple.org/learn/user-guide/standalone-application/"><meta property="og:title" content="Standalone Application User Guide | Eclipse Keyple"><meta property="og:description" content="How to develop an end-user standalone application."><meta property="og:image" content="https://keyple.org/media/logo.svg"><meta property="og:locale" content="en-us"><meta property="article:modified_time" content="2024-11-27T10:20:12+01:00"><title>Standalone Application User Guide | Eclipse Keyple</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=e77ca063ee6572d6bf15d5656980094d><script src=../../../js/wowchemy-init.min.d66af272089c6c0601f1a57edc3bf6ab.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=../../../><img src=../../../media/logo.svg alt="Eclipse Keyple"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=../../../><img src=../../../media/logo.svg alt="Eclipse Keyple"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>What is Eclipse Keyple速</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=../../../what-is-keyple/overview/><span>Overview</span></a>
<a class=dropdown-item href=../../../what-is-keyple/why-trust/><span>Why trust Eclipse Keyple速?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/who-is-it-for/><span>Who is it for?</span></a>
<a class=dropdown-item href=../../../#adopters><span>Who is using Eclipse Keyple速?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/what-is-calypso/><span>What is Calypso速?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/main-features/><span>Keyple's main features</span></a>
<a class=dropdown-item href=../../../#news><span>News</span></a></div></li><li class=nav-item><a class=nav-link href=../../../learn/overview><span>Learn</span></a></li><li class=nav-item><a class=nav-link href=../../../components/overview><span>Components</span></a></li><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>Community</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=../../../adopters-and-testimonials/><span>Adopters & Testimonials</span></a>
<a class=dropdown-item href=../../../community/contributing/><span>Contributing</span></a>
<a class=dropdown-item href=../../../community/roadmap/><span>Roadmap</span></a>
<a class=dropdown-item href=../../../community/changelog/><span>Changelog</span></a>
<a class=dropdown-item href=../../../project-dashboard/><span>Project dashboard</span></a>
<a class=dropdown-item href=../../../statistics/><span>Statistics</span></a>
<a class=dropdown-item href="https://sonarcloud.io/organizations/eclipse/projects?search=keyple&amp;sort=-analysis_date"><span>Code quality dashboard</span></a>
<a class=dropdown-item href=https://projects.eclipse.org/projects/iot.keyple/><span>Eclipse Foundation Keyple page</span></a>
<a class=dropdown-item href=https://accounts.eclipse.org/mailing-list/keyple-dev/><span>Mailing list</span></a>
<a class=dropdown-item href=https://github.com/eclipse-keyple/><span>GitHub home repository</span></a>
<a class=dropdown-item href=https://docs.keyple.org/><span>All APIs docs</span></a></div></li><li class=nav-item><a class=nav-link href=../../../external-resources/><span>External resources</span></a></li><li class=nav-item><a class=nav-link href=../../../learn/build-your-first-app/><button class='btn btn-info'><i class='fas fa-rocket pr-1' aria-hidden=true></i> <span>START CODING</span></button></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav></header></div><div class=page-body><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">User guides
</span><span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>Search...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li><a href=../../../learn/></a></li><div class=docs-toc-item><a class=docs-toc-link href=../../../learn/overview/>Overview</a><ul class="nav docs-sidenav"><li><a href=../../../learn/overview/key-concepts/>Key concepts</a></li><li><a href=../../../learn/overview/architecture/>Architecture</a></li><li><a href=../../../learn/overview/keypop-api/>Keypop API</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=../../../learn/build-your-first-app/>Build your first app</a><ul class="nav docs-sidenav"><li><a href=../../../learn/build-your-first-app/java-app/>Java</a></li><li><a href=../../../learn/build-your-first-app/android-app/>Android</a></li><li><a href=../../../learn/build-your-first-app/cpp-app/>C++</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=../../../learn/user-guide/>User guides</a><ul class="nav docs-sidenav"><li class=active><a href=../../../learn/user-guide/standalone-application/>Standalone application</a></li><li><a href=../../../learn/user-guide/distributed-application/>Distributed application</a></li><li><a href=../../../learn/user-guide/server-json-api/>Server JSON API for non-Keyple clients</a></li><li><a href=../../../learn/user-guide/calypso-application/>Calypso application</a></li><li><a href=../../../learn/user-guide/card-resource-service/>Card resource service</a></li><li><a href=../../../learn/user-guide/migration-guide/>How to upgrade Keyple</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=../../../learn/developer-guide/>Developer guides</a><ul class="nav docs-sidenav"><li><a href=../../../learn/developer-guide/reader-plugin-add-on/>Reader plugin add-on</a></li><li><a href=../../../learn/developer-guide/card-extension-add-on/>Card extension add-on</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=../../../learn/code-samples/>Code samples</a><ul class="nav docs-sidenav"><li><a href=../../../learn/code-samples/java-example/>Java examples</a></li><li><a href=../../../learn/code-samples/cpp-example/>C++ examples</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=../../../learn/keyple-in-depth/>Keyple in depth</a><ul class="nav docs-sidenav"><li><a href=../../../learn/keyple-in-depth/core-services/>Core services</a></li><li><a href=../../../learn/keyple-in-depth/calypso-card-extension/>Calypso card extension</a></li><li><a href=../../../learn/keyple-in-depth/build-and-ci/>Build and CI</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=../../../learn/archives/>Archives</a></div></ul></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#operating-mode>Operating mode</a></li><li><a href=#the-smart-card-service>The smart card service</a></li><li><a href=#set-up-a-plugin>Set up a plugin</a><ul><li><a href=#access-to-a-plugin>Access to a plugin</a></li><li><a href=#configure-a-plugin>Configure a plugin</a></li><li><a href=#monitor-a-plugin>Monitor a plugin</a></li></ul></li><li><a href=#set-up-a-reader>Set up a reader</a><ul><li><a href=#access-to-a-reader>Access to a reader</a></li><li><a href=#configure-a-reader>Configure a reader</a></li><li><a href=#monitor-a-reader>Monitor a reader</a></li></ul></li><li><a href=#select-a-card>Select a card</a><ul><li><a href=#prepare-a-scenario>Prepare a scenario</a></li><li><a href=#run-a-scenario>Run a scenario</a></li><li><a href=#schedule-a-scenario>Schedule a scenario</a></li></ul></li><li><a href=#perform-a-transaction>Perform a transaction</a></li><li><a href=#unregister-a-plugin>Unregister a plugin</a></li><li><a href=#api>API</a></li><li><a href=#examples>Examples</a></li><li><a href=#download>Download</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><div class=docs-article-container></div><div class=docs-article-container><h1>Standalone Application User Guide</h1><article class=article-style><br><h2 id=overview>Overview</h2><p>A standalone application is an application that runs in a device in contact
with the end user.</p><p>It has at least one local smart card reader and manages itself the
interaction with the user.</p><p>The diagram below illustrates the organization of a standalone application based on Keyple:<figure><div class="d-flex justify-content-center"><div class=w-100><img src=../../../media/learn/user-guide/standalone-application/standalone_application_overview.drawio.svg alt loading=lazy data-zoomable></div></div></figure></p><br><h2 id=operating-mode>Operating mode</h2><div class="alert alert-warning"><div>If you are new to Keyple, read the <a href=../../../learn/overview/key-concepts/>key concepts</a> page and familiarize yourself with the fundamentals behind Keyple.</div></div><ol><li>Access to the <a href=#the-smart-card-service>smart card service</a></li><li><a href=#set-up-a-plugin>Set up a plugin</a></li><li><a href=#set-up-a-reader>Set up a reader</a></li><li><a href=#select-a-card>Select a card</a></li><li><a href=#perform-a-transaction>Perform a transaction</a></li></ol><h2 id=the-smart-card-service>The smart card service</h2><p>As part of Keyple Service component, the smart card service is the main service of Keyple. Its role is to centralize the add-on resources and to manage their
life cycle.</p><p>The service is accessible by invoking the <code>SmartCardServiceProvider.getService()</code> static method.</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>SmartCardService</span><span class=w> </span><span class=n>smartCardService</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>SmartCardServiceProvider</span><span class=p>.</span><span class=na>getService</span><span class=p>();</span></span></span></code></pre></div></div></div><br><h2 id=set-up-a-plugin>Set up a plugin</h2><p>The Keyple application developer will choose the reader plugins he needs
according to the equipment on which the Keyple application will run.</p><p>For example, if the environment is PC-based, the PC/SC plugin will probably, but not necessarily, be chosen.
For an Andoid terminal environment, the plugin could be the standard
Android NFC plugin or one of the plugins available from the industrial
partners of the project.</p><p>For a complete list of available plugins, please see
the <a href=https://keyple.org/components/standard-reader-plugins/>standard reader plugins</a>,
the <a href=https://keyple.org/components/specific-reader-plugins/>specific reader plugins</a>
or one of our <a href=https://keyple.org/external-resources/>partners reader plugins</a>.</p><div class="alert alert-note"><div>A new plugin can also be <a href=../../../learn/developer-guide/reader-plugin-add-on/>created</a> if there is no plugin for the intended hardware.</div></div><h3 id=access-to-a-plugin>Access to a plugin</h3><p>To access a plugin at the application level, it must first be registered with the smart card service via the <code>registerPlugin(...)</code> method.
It will be necessary to provide an implementation of the <code>KeyplePluginExtensionFactory</code> interface.
This factory is provided by the API of the used plugin.</p><p>Depending on the capabilities of the hardware, the plugin factory may or may not offer specific configuration options.
Please refer to the API of the plugin component you are considering to see what is appropriate for your application.</p><p>The registration provides in return an implementation of one of the <code>Plugin</code>, <code>ObservablePlugin</code> or <code>PoolPlugin</code> interfaces depending on the type of target plugin.</p><div class="alert alert-note"><div>A plugin is identified by a unique name in the system so that it can be retrieved at any time from the smart card service.</div></div><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Here is for example the registration of the PC/SC plugin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Plugin</span><span class=w> </span><span class=n>plugin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>smartCardService</span><span class=p>.</span><span class=na>registerPlugin</span><span class=p>(</span><span class=n>PcscPluginFactoryBuilder</span><span class=p>.</span><span class=na>builder</span><span class=p>().</span><span class=na>build</span><span class=p>());</span></span></span></code></pre></div></div></div><h3 id=configure-a-plugin>Configure a plugin</h3><p>Some plugin types may offer specific options.</p><p>Static options are usually directly exposed by the plugin factory API while dynamic options are exposed by the plugin extension API.</p><p>To access the plugin extension it is necessary to invoke the <code>getExtension(...)</code> method on the registered <code>Plugin</code> by specifying the expected class of the extension which must extends the <code>KeyplePluginExtension</code> interface.
After that, the dedicated methods are available from the resulting object.</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Here is a snippet showing the usage of the extension of the Stub plugin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>plugin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>getExtension</span><span class=p>(</span><span class=n>StubPlugin</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>unplugReader</span><span class=p>(</span><span class=s>&#34;READER_1&#34;</span><span class=p>);</span></span></span></code></pre></div></div></div><h3 id=monitor-a-plugin>Monitor a plugin</h3><div class="alert alert-warning"><div>The plugin monitoring only applies to hardware environments in which the readers are removable.
Moreover, only plugins of type <code>ObservablePlugin</code> can be monitored.</div></div><p>The observation of reader connections and disconnections is achieved
through a background task managed by Keyple Service.</p><p>To enable these observation mechanisms, it is imperative to provide:</p><ul><li>a plugin observer implementing the <code>PluginObserverSpi</code> interface to be notified of plugin events,</li><li>an exception handler implementing the <code>PluginObservationExceptionHandlerSpi</code> interface to be notified of errors that may occur during the monitoring or events notifications.</li></ul><p>These two interfaces are available in the <code>org.eclipse.keyple.core.service.spi</code> package of the Keyple Service component.</p><p>Here is an example of a plugin observer class including an exception handler:</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>PluginObserver</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>PluginObserverSpi</span><span class=p>,</span><span class=w> </span><span class=n>PluginObservationExceptionHandlerSpi</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onPluginEvent</span><span class=p>(</span><span class=n>PluginEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getEventType</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=n>READER_CONNECTED</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// here the processing to be done when a reader is connected</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=n>READER_DISCONNECTED</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// here the processing to be done when a reader is disconnected</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onPluginObservationError</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>pluginName</span><span class=p>,</span><span class=w> </span><span class=n>Throwable</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// handle here the plugin exceptions raised while observing the readers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></div></div></div><p>In order to access the dedicated setters, the plugin has to be cast to <code>ObservablePlugin</code>.</p><p>Since adding an observer will cause the Keyple Service to check for the presence of an exception handler,
the definition of the exception handler must be done first.</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>PluginObserver</span><span class=w> </span><span class=n>pluginObserver</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>PluginObserver</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>((</span><span class=n>ObservablePlugin</span><span class=p>)</span><span class=w> </span><span class=n>plugin</span><span class=p>).</span><span class=na>setPluginObservationExceptionHandler</span><span class=p>(</span><span class=n>pluginObserver</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>((</span><span class=n>ObservablePlugin</span><span class=p>)</span><span class=w> </span><span class=n>plugin</span><span class=p>).</span><span class=na>addObserver</span><span class=p>(</span><span class=n>pluginObserver</span><span class=p>);</span></span></span></code></pre></div></div></div><div class="alert alert-note"><div>Note that the monitoring thread only works if there is at least one observer registered, and the notification process is sequential and synchronous.</div></div><br><h2 id=set-up-a-reader>Set up a reader</h2><p>The readers are provided by the plugins, that&rsquo;s why you have to <a href=#set-up-a-plugin>set up the plugin</a> first.</p><h3 id=access-to-a-reader>Access to a reader</h3><p>The hardware readers already connected are referenced in the system during the registration of the plugin.
For observable plugins, the references of the connected readers are updated in real time.</p><p>Readers are accessible directly from the associated <code>Plugin</code> instance.</p><p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Here is an example to get the 1st available reader</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>readerName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>plugin</span><span class=p>.</span><span class=na>getReaderNames</span><span class=p>().</span><span class=na>get</span><span class=p>(</span><span class=n>0</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CardReader</span><span class=w> </span><span class=n>reader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>plugin</span><span class=p>.</span><span class=na>getReader</span><span class=p>(</span><span class=n>readerName</span><span class=p>);</span></span></span></code></pre></div></div></div><br></p><div class="alert alert-note"><div>Depending on the type of plugin, the reader names are
more or less dynamic (e.g. a PC/SC based system vs. an embedded
terminal), it is sometimes necessary to implement an identification
mechanism in order to assign the right reader to the right place in the
system (for example by using regular expressions).</div></div><h3 id=configure-a-reader>Configure a reader</h3><p>There are two types of configuration. Their availability depends on the characteristics of the reader:</p><ul><li><p>The reader is an instance of <code>ConfigurableCardReader</code>:<br>It is then possible to activate or deactivate the protocols supported by the reader.</p><div class="alert alert-note"><div>Use of these methods may be optional if the application does not intend to target products by protocol filtering.</div></div></li><li><p>The reader&rsquo;s extension API exposes specific options:<br>To access the reader extension it is necessary to invoke the <code>getReaderExtension(...)</code> method on the <code>Plugin</code> instance by specifying the expected class of the extension (which must extends the <code>KeypleReaderExtension</code> interface) and the reader&rsquo;s name.
After that, the dedicated methods, if any, are available from the resulting object.<div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Here is a snippet showing how to get and use the extension of the Stub reader</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>plugin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>getReaderExtension</span><span class=p>(</span><span class=n>StubReader</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>readerName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>removeCard</span><span class=p>();</span></span></span></code></pre></div></div></div></p></li></ul><h3 id=monitor-a-reader>Monitor a reader</h3><div class="alert alert-warning"><div>The reader monitoring only applies to hardware environments in which the smart cards are removable.
Moreover, only readers of type <code>ObservableCardReader</code> can be monitored.</div></div><div class="alert alert-note"><div>Observation of the readers is optional in Keyple. It facilitates an event-driven programming mode, but an application
developer can choose not to observe a reader, either because this reader is not designed to manage card insertions/withdrawals (for example an
Android OMAPI reader or a SAM reader), or because the application is designed to directly manage the presence of a card (see to <code>isCardPresent</code> method of the
<code>CardReader</code> interface).</div></div><p>The observation of card insertions and removals is achieved
through a background task managed by Keyple Service.</p><p>To enable these observation mechanisms, it is imperative to provide:</p><ul><li>a reader observer implementing the <code>CardReaderObserverSpi</code> interface to be notified of reader events,</li><li>an exception handler implementing the <code>CardReaderObservationExceptionHandlerSpi</code> interface to be notified of errors that may occur during the monitoring or events notifications.</li></ul><p>These two interfaces are available in the <code>org.eclipse.keypop.reader.spi</code> package of the <strong>Keypop Reader API</strong> component.</p><p>Here is an example of a reader observer class including an exception handler:</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>ReaderObserver</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>CardReaderObserverSpi</span><span class=p>,</span><span class=w> </span><span class=n>CardReaderObservationExceptionHandlerSpi</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onReaderEvent</span><span class=p>(</span><span class=n>CardReaderEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getType</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=n>CardReaderEvent</span><span class=p>.</span><span class=na>Type</span><span class=p>.</span><span class=na>CARD_INSERTED</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// here the processing to be done when a card is inserted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=n>CardReaderEvent</span><span class=p>.</span><span class=na>Type</span><span class=p>.</span><span class=na>CARD_REMOVED</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// here the processing to be done when a card is removed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onReaderObservationError</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>pluginName</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>readerName</span><span class=p>,</span><span class=w> </span><span class=n>Throwable</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// handle here the reader exceptions raised while observing the cards</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></div></div></div><p>In order to access the dedicated setters, the reader has to be cast to <code>ObservableCardReader</code>.</p><p>Since adding an observer will cause the Keyple Service to check for the presence of an exception handler,
the definition of the exception handler must be done first.</p><p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ReaderObserver</span><span class=w> </span><span class=n>readerObserver</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ReaderObserver</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>((</span><span class=n>ObservableCardReader</span><span class=p>)</span><span class=w> </span><span class=n>reader</span><span class=p>).</span><span class=na>setReaderObservationExceptionHandler</span><span class=p>(</span><span class=n>readerObserver</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>((</span><span class=n>ObservableCardReader</span><span class=p>)</span><span class=w> </span><span class=n>reader</span><span class=p>).</span><span class=na>addObserver</span><span class=p>(</span><span class=n>readerObserver</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>((</span><span class=n>ObservableCardReader</span><span class=p>)</span><span class=w> </span><span class=n>reader</span><span class=p>).</span><span class=na>startCardDetection</span><span class=p>(</span><span class=n>ObservableCardReader</span><span class=p>.</span><span class=na>DetectionMode</span><span class=p>.</span><span class=na>REPEATING</span><span class=p>);</span></span></span></code></pre></div></div></div><br></p><div class="alert alert-note"><div>Note that the <code>startCardDetection(...)</code> and <code>stopCardDetection()</code> methods start and stop the monitoring thread.
The API offers different options to manage the needs around card detection.<br>Moreover, the notification process is sequential and synchronous.</div></div><br><h2 id=select-a-card>Select a card</h2><p>The starting point of any processing done with a card in the Keyple environment, is to reference this card in the system.
It is the role of the selection step to obtain this reference.</p><p>You have first to prepare a selection scenario defining the eligible cards for a transaction, then to execute the scenario when a card is present.</p><h3 id=prepare-a-scenario>Prepare a scenario</h3><p>To prepare a scenario, you have to get a new instance of <code>CardSelectionManager</code> from the smart card service using the
<code>getReaderApiFactory().createCardSelectionManager()</code> method,
then configure it with scenario cases using dedicated methods provided by one or more card extensions.</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>CardSelectionManager</span><span class=w> </span><span class=n>cardSelectionManager</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>smartCardService</span><span class=p>.</span><span class=na>getReaderApiFactory</span><span class=p>().</span><span class=na>createCardSelectionManager</span><span class=p>();</span></span></span></code></pre></div></div></div><p>The <code>prepareSelection(...)</code> method allows to add a selection case to the scenario by providing a specific <code>CardSelector</code>
and an implementation of the <code>CardSelectionExtension</code> interface.
The method will return the index of the added case in order to be able to identify later the case that matched.</p><p>Please note that the order of addition is important because it will impact the selection cycle and favor the performance
of the first added cases.</p><p>Providing one or more selection cases to the <code>CardSelectionManager</code> constitutes a selection scenario.
The scenario is run by Keyple Service when a card is detected, the different cases being evaluated
sequentially as long as the card does not match the criteria of the defined cases.</p><p>The selection process for a case offers several options for selecting a processing based on the type of card presented
to the reader.</p><p>It is based on a filtering process according to three possible criteria, each of which is optional:</p><ul><li>the communication protocol of the card (usually also identifying a card technology),</li><li>the power-on data collected by the reader when the card is detected (e.g. the Answer To Reset),</li><li>the ISO standard application identifier (AID) used to perform a Select Application command.</li></ul><p>When a card is inserted, it is evaluated according to these criteria and will be given the status &ldquo;selected&rdquo; or not.</p><p>When a card is not selected, no other operation will be possible with it.</p><p>The same card could correspond to several cases of the same scenario, especially when filtering by AID.
By default, the selection process will stop at the first case that matches.
It is however possible to choose another strategy using the <code>setMultipleSelectionMode()</code> method.
In this case, the process will continue to the last selection case in the scenario and return all results,
but only the last matching application will be selected.</p><p>When a card is selected, the <code>CardSelectionManager</code> will make available the result
as a <code>SmartCard</code> (or <code>IsoSmartCard</code> if an <code>IsoCardSelector</code> is used) containing all the information known about the
card at that stage.</p><p>Depending on the card extension that is used, this <code>SmartCard</code> object can be cast to a more
comprehensive object with specific features defined by the extension.</p><p>In addition to the selection process itself, specific APDU commands may be sent to the card if the selection is
successful.
The output of these commands is available in the instance of the <code>SmartCard</code> object.</p><p>The following snippet shows the preparation of two selection cases using the generic card extension:<div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// prepare a selection for application 1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kt>int</span><span class=w> </span><span class=n>firstCaseIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cardSelectionManager</span><span class=p>.</span><span class=na>prepareSelection</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>smartCardService</span><span class=p>.</span><span class=na>getReaderApiFactory</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>createIsoCardSelector</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>filterByDfName</span><span class=p>(</span><span class=n>AID1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>GenericExtensionService</span><span class=p>.</span><span class=na>getInstance</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>createGenericCardSelectionExtension</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// prepare a selection for application 2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kt>int</span><span class=w> </span><span class=n>secondCaseIndex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cardSelectionManager</span><span class=p>.</span><span class=na>prepareSelection</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>smartCardService</span><span class=p>.</span><span class=na>getReaderApiFactory</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>createIsoCardSelector</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>filterByDfName</span><span class=p>(</span><span class=n>AID2</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>GenericExtensionService</span><span class=p>.</span><span class=na>getInstance</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>createGenericCardSelectionExtension</span><span class=p>());</span></span></span></code></pre></div></div></div></p><h3 id=run-a-scenario>Run a scenario</h3><p>If we know that the card is in the reader it is possible to run a selection scenario by invoking the <code>processCardSelectionScenario(...)</code> method on the corresponding reader.
The result of the selection is then directly returned.</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Actual card communication: run the selection scenario.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CardSelectionResult</span><span class=w> </span><span class=n>selectionResult</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cardSelectionManager</span><span class=p>.</span><span class=na>processCardSelectionScenario</span><span class=p>(</span><span class=n>reader</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Get the SmartCard resulting of the selection.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>SmartCard</span><span class=w> </span><span class=n>smartCard</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>selectionResult</span><span class=p>.</span><span class=na>getActiveSmartCard</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Check the selection result.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>smartCard</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>IllegalStateException</span><span class=p>(</span><span class=s>&#34;The selection of the card failed.&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></div></div></div><h3 id=schedule-a-scenario>Schedule a scenario</h3><p>If the reader is of type <code>ObservableCardReader</code> then it is possible to schedule in advance the execution of a selection scenario as soon as a card is presented.</p><p>Invoke the <code>scheduleCardSelectionScenario(...)</code> to register the previously prepared scenario in the observable reader.</p><p>In this case, it is necessary to register a reader observer and to have started the card detection in order to be able to retrieve the result of the selection which will be contained in a <code>CardReaderEvent</code>.</p><p>Use the <code>parseScheduledCardSelectionsResponse(...)</code> method to extract the selection result from the event.</p><p>Note that the scheduling of the execution of a scenario includes the <code>NotificationMode</code> option allowing to choose if
only the cards matching the selection (successfully selected) should trigger an event.</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onReaderEvent</span><span class=p>(</span><span class=n>CardReaderEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getType</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>case</span><span class=w> </span><span class=n>CardReaderEvent</span><span class=p>.</span><span class=na>Type</span><span class=p>.</span><span class=na>CARD_MATCHED</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Retrieve the selected smart card</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SmartCard</span><span class=w> </span><span class=n>smartCard</span><span class=w> </span><span class=o>=</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>cardSelectionManager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseScheduledCardSelectionsResponse</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getScheduledCardSelectionsResponse</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>getActiveSmartCard</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Perform the transaction</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// Ensures that the communication channel is closed, regardless of the processing with the card.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>((</span><span class=n>ObservableCardReader</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>reader</span><span class=p>)).</span><span class=na>finalizeCardProcessing</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>...</span></span></span></code></pre></div></div></div><br><div class="alert alert-note"><div><p>The <code>finalizeCardProcessing()</code> method must be invoked at the end of the transaction to ensure that the communication
channel is closed.
This switches the underlying monitoring thread into a state of waiting for the card to be removed.</p><p>Not doing this can lead to blocking states of the card insertion/removal monitoring mechanism.</p></div></div><br><h2 id=perform-a-transaction>Perform a transaction</h2><p>Once the smart card is referenced in the system it is possible to perform the desired transaction using the appropriate
card extension.</p><p>When the transaction is completed, if the reader is observed, it is imperative to invoke the <code>finalizeCardProcessing()</code>
method on the observable reader (see the above note).</p><br><h2 id=unregister-a-plugin>Unregister a plugin</h2><p>To shut down a Keyple application properly, it is necessary to free the resources and in particular to close opened card
physical channels and stop the observation threads.</p><p>This is done by unregistering the plugins in the following way:</p><div class="code relative"><div class="code-copy-content nt3"><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>smartCardService</span><span class=p>.</span><span class=na>unregisterPlugin</span><span class=p>(</span><span class=n>plugin</span><span class=p>.</span><span class=na>getName</span><span class=p>());</span></span></span></code></pre></div></div></div><br><h2 id=api>API</h2><ul><li><a href=https://keypop.org/apis/reader-layer/reader-api/ target=_blank rel=noopener>Keypop Reader API</a></li><li><a href=https://docs.keyple.org/keyple-common-java-api target=_blank rel=noopener>Keyple Common API</a></li><li><a href=https://docs.keyple.org/keyple-service-java-lib target=_blank rel=noopener>Keyple Service API</a></li></ul><br><h2 id=examples>Examples</h2><ul><li><a href=https://github.com/eclipse-keyple/keyple-java-example target=_blank rel=noopener>Java examples</a></li></ul><br><h2 id=download>Download</h2><ul><li><a href=https://keyple.org/components/overview/configuration-wizard/>Java components</a></li></ul></article><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Next</div><a href=../../../learn/user-guide/distributed-application/ rel=prev>Distributed Application User Guide</a></div></div></div></div><div class=body-footer><p>Last updated on 2024-11-27</p></div><footer class=site-footer><div class=container><div class="row featurette"><div class="col-12 col-sm-4"><p style=color:#fff><b>ECLIPSE LEGAL</b></p><a href=https://www.eclipse.org/legal/privacy.php>Privacy Policy</a><br><a href=https://www.eclipse.org/legal/termsofuse.php>Terms of Use</a><br><a href=https://www.eclipse.org/legal/copyright.php>Copyright Agent</a><br><a href=https://www.eclipse.org/legal/epl-2.0/>Eclipse Public License</a><br><a href=https://www.eclipse.org/legal/>Legal Resources</a><br><a href=https://eclipse.org/security/ target=_blank>Report a Vulnerability</a><br></div><div class="col-12 col-sm-4"><a href=https://www.eclipse.org target=_blank><img src=../../../media/eclipse_foundation_logo.svg id=logo-eclipse-foundation></a></div><div class="col-12 col-sm-4"><a href=https://iot.eclipse.org target=_blank><img src=../../../media/eclipse_iot_logo.svg id=logo-eclipse-iot></a></div></div></div><p class="powered-by copyright-license-text">息 2019-2024 The Eclipse Keyple速 project. All Rights Reserved.</p><p class=powered-by id=template-info>Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target=_blank rel=noopener>Hugo Blox Builder</a>  the free, <a href=https://github.com/HugoBlox/hugo-blox-builder target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></main></div></div></div><div class=page-footer></div><script src=../../../js/vendor-bundle.min.938a3a7554cd9f6602290411f64d2617.js></script><script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js integrity="sha256-aQmOEF2ZD4NM/xt4hthzREIo/2PFkOX/g01WjxEV7Ys=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script><script id=page-data type=application/json>{"use_headroom":false}</script><script src=../../../en/js/wowchemy.min.93835b657bcc2e8eb7785dd0776d4457.js></script><script src=../../../js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script><link rel=stylesheet href=https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap4.min.css><script src=https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js></script><script src=https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js></script><script src=https://d3js.org/d3.v6.min.js></script></body></html>