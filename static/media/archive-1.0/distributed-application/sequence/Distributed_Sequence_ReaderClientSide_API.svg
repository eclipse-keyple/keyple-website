<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="5430px" preserveAspectRatio="none" style="width:4192px;height:5430px;" version="1.1" viewBox="0 0 4192 5430" width="4192.5px" zoomAndPan="magnify"><defs><filter height="1" id="b1ud6w416031hq0" width="1" x="0" y="0"><feFlood flood-color="#ADD8E6" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><rect fill="#FEF9E7" height="5358.2617" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 2.5;" width="2062.5" x="307.5" y="15"/><text fill="#000000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="422.5" x="1127.5" y="48.7378">Client APP using Local Lib</text><rect fill="#FDF2E9" height="5358.2617" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 2.5;" width="1710" x="2375" y="15"/><text fill="#000000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="470" x="2995" y="48.7378">Server APP using Remote Lib</text><rect fill="#FFFFE0" height="3332.5586" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="93.75" y="1765.1563"/><rect fill="#ADD8E6" height="303.5156" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="488.75" y="1765.1563"/><rect fill="#ADD8E6" height="116.5234" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="835" y="1093.3594"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="835" y="1505.0195"/><rect fill="#FFC0CB" height="4376.0156" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="1442.5" y="721.6992"/><rect fill="#ADD8E6" height="2398.6328" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="2165" y="2676.582"/><rect fill="#ADD8E6" height="182.4023" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="2572.5" y="2711.582"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="2572.5" y="2969.8633"/><rect fill="#ADD8E6" height="110.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="2572.5" y="4888.457"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="3121.6211"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="3682.7734"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="3875.4102"/><rect fill="#ADD8E6" height="35" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="4027.168"/><rect fill="#ADD8E6" height="227.6367" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="4459.0625"/><rect fill="#FFC0CB" height="4761.2891" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3753.75" y="336.4258"/><rect fill="#FDF2E9" height="498.6523" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 5.0;" width="4096.25" x="25" y="4208.0469"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 5.0,5.0;" x1="105" x2="105" y1="311.4258" y2="5120.2148"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 5.0,5.0;" x1="500" x2="500" y1="1166.6211" y2="5120.2148"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 5.0,5.0;" x1="847.5" x2="847.5" y1="1054.9805" y2="5120.2148"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 5.0,5.0;" x1="1455" x2="1455" y1="311.4258" y2="5120.2148"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 5.0,5.0;" x1="2177.5" x2="2177.5" y1="943.3398" y2="5120.2148"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 5.0,5.0;" x1="2585" x2="2585" y1="551.123" y2="5120.2148"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 5.0,5.0;" x1="3120" x2="3120" y1="2809.8438" y2="5120.2148"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 5.0,5.0;" x1="3765" x2="3765" y1="311.4258" y2="5120.2148"/><rect fill="#FEFECE" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="112.5" x="50" y="229.9023"/><text fill="#000000" font-family="sans-serif" font-size="35" lengthAdjust="spacingAndGlyphs" textLength="77.5" x="67.5" y="283.7354">Card</text><rect fill="#FEFECE" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="112.5" x="50" y="5117.7148"/><text fill="#000000" font-family="sans-serif" font-size="35" lengthAdjust="spacingAndGlyphs" textLength="77.5" x="67.5" y="5171.5479">Card</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="367.5" x="317.5" y="5117.7148"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="332.5" x="335" y="5171.5479">ObservableReader</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="145" x="775" y="5117.7148"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="792.5" y="5171.5479">Plugin</text><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="305" x="1295" y="303.7354">Ticketing Service</text><ellipse cx="1455" cy="134.9023" fill="#FEFECE" rx="20" ry="20" style="stroke: #A80036; stroke-width: 5.0;"/><path d="M1455,154.9023 L1455,222.4023 M1422.5,174.9023 L1487.5,174.9023 M1455,222.4023 L1422.5,259.9023 M1455,222.4023 L1487.5,259.9023 " fill="none" style="stroke: #A80036; stroke-width: 5.0;"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="305" x="1295" y="5154.0479">Ticketing Service</text><ellipse cx="1455" cy="5186.7383" fill="#FEFECE" rx="20" ry="20" style="stroke: #A80036; stroke-width: 5.0;"/><path d="M1455,5206.7383 L1455,5274.2383 M1422.5,5226.7383 L1487.5,5226.7383 M1455,5274.2383 L1422.5,5311.7383 M1455,5274.2383 L1487.5,5311.7383 " fill="none" style="stroke: #A80036; stroke-width: 5.0;"/><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="365" x="1995" y="5117.7148"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="330" x="2012.5" y="5171.5479">LocalServiceClient</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="400" x="2385" y="5117.7148"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="365" x="2402.5" y="5171.5479">RemotePluginServer</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="622.5" x="2810" y="5117.7148"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="587.5" x="2827.5" y="5171.5479">ObservableRemoteReaderServer</text><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="450" x="3528.75" y="259.7119">Remote Ticketing Service</text><text fill="#000000" font-family="sans-serif" font-size="35" lengthAdjust="spacingAndGlyphs" textLength="10" x="3978.75" y="259.7119">:</text><text fill="#000000" filter="url(#b1ud6w416031hq0)" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="602.5" x="3457.5" y="303.7354">ObservablePlugin.PluginObserver</text><ellipse cx="3766.25" cy="90.8789" fill="#FEFECE" rx="20" ry="20" style="stroke: #A80036; stroke-width: 5.0;"/><path d="M3766.25,110.8789 L3766.25,178.3789 M3733.75,130.8789 L3798.75,130.8789 M3766.25,178.3789 L3733.75,215.8789 M3766.25,178.3789 L3798.75,215.8789 " fill="none" style="stroke: #A80036; stroke-width: 5.0;"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="450" x="3528.75" y="5154.0479">Remote Ticketing Service</text><text fill="#000000" font-family="sans-serif" font-size="35" lengthAdjust="spacingAndGlyphs" textLength="10" x="3978.75" y="5154.0479">:</text><text fill="#000000" filter="url(#b1ud6w416031hq0)" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="602.5" x="3457.5" y="5198.0713">ObservablePlugin.PluginObserver</text><ellipse cx="3766.25" cy="5230.7617" fill="#FEFECE" rx="20" ry="20" style="stroke: #A80036; stroke-width: 5.0;"/><path d="M3766.25,5250.7617 L3766.25,5318.2617 M3733.75,5270.7617 L3798.75,5270.7617 M3766.25,5318.2617 L3733.75,5355.7617 M3766.25,5318.2617 L3798.75,5355.7617 " fill="none" style="stroke: #A80036; stroke-width: 5.0;"/><rect fill="#FFFFE0" height="3332.5586" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="93.75" y="1765.1563"/><rect fill="#ADD8E6" height="303.5156" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="488.75" y="1765.1563"/><rect fill="#ADD8E6" height="116.5234" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="835" y="1093.3594"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="835" y="1505.0195"/><rect fill="#FFC0CB" height="4376.0156" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="1442.5" y="721.6992"/><rect fill="#ADD8E6" height="2398.6328" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="2165" y="2676.582"/><rect fill="#ADD8E6" height="182.4023" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="2572.5" y="2711.582"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="2572.5" y="2969.8633"/><rect fill="#ADD8E6" height="110.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="2572.5" y="4888.457"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="3121.6211"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="3682.7734"/><rect fill="#ADD8E6" height="75.8789" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="3875.4102"/><rect fill="#ADD8E6" height="35" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="4027.168"/><rect fill="#ADD8E6" height="227.6367" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3108.75" y="4459.0625"/><rect fill="#FFC0CB" height="4761.2891" style="stroke: #A80036; stroke-width: 2.5;" width="25" x="3753.75" y="336.4258"/><rect fill="#EEEEEE" height="7.5" style="stroke: #EEEEEE; stroke-width: 2.5;" width="4176.25" x="0" y="389.3652"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="389.3652" y2="389.3652"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="396.8652" y2="396.8652"/><rect fill="#EEEEEE" height="60.8789" style="stroke: #000000; stroke-width: 5.0;" width="435" x="1870.625" y="361.4258"/><text fill="#000000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="390" x="1885.625" y="405.1636">Remote Lib Initialization</text><polygon fill="#A80036" points="2812.5,574.9414,2787.5,584.9414,2812.5,594.9414,2802.5,584.9414" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="2797.5" x2="3751.25" y1="584.9414" y2="584.9414"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="462.5" x="2827.5" y="491.0425">smartCardService.registerPlugin</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="442.5" x="2837.5" y="531.9214">(RemotePluginServerFactory...</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="407.5" x="2867.5" y="572.8003">.withPluginObserver (this)...)</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="400" x="2385" y="498.418"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="365" x="2402.5" y="552.251">RemotePluginServer</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="3778.75" x2="3896.25" y1="689.1992" y2="689.1992"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3896.25" x2="3896.25" y1="689.1992" y2="721.6992"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3793.75" x2="3896.25" y1="721.6992" y2="721.6992"/><polygon fill="#A80036" points="3818.75,711.6992,3793.75,721.6992,3818.75,731.6992,3808.75,721.6992" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="265" x="3808.75" y="636.1792">Awaiting receipt of</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="237.5" x="3818.75" y="677.0581">a Plugin Event...</text><rect fill="#EEEEEE" height="7.5" style="stroke: #EEEEEE; stroke-width: 2.5;" width="4176.25" x="0" y="807.1387"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="807.1387" y2="807.1387"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="814.6387" y2="814.6387"/><rect fill="#EEEEEE" height="60.8789" style="stroke: #000000; stroke-width: 5.0;" width="400" x="1888.125" y="779.1992"/><text fill="#000000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="355" x="1903.125" y="822.937">Local Lib Initialization</text><polygon fill="#A80036" points="1965,910.957,1990,920.957,1965,930.957,1975,920.957" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1467.5" x2="1980" y1="920.957" y2="920.957"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="405" x="1485" y="908.8159">LocalServiceClientFactory...</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="365" x="1995" y="865.0781"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="330" x="2012.5" y="918.9111">LocalServiceClient</text><polygon fill="#A80036" points="947.5,1058.3594,922.5,1068.3594,947.5,1078.3594,937.5,1068.3594" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="932.5" x2="1440" y1="1068.3594" y2="1068.3594"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="462.5" x="962.5" y="1015.3394">smartCardService.registerPlugin</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="270" x="972.5" y="1056.2183">(new XXXFactory())</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="145" x="775" y="981.8359"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="792.5" y="1035.6689">Plugin</text><polygon fill="#A80036" points="712.5,1134.2383,687.5,1144.2383,712.5,1154.2383,702.5,1144.2383" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="697.5" x2="832.5" y1="1144.2383" y2="1144.2383"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="90" x="727.5" y="1132.0972">create</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="367.5" x="317.5" y="1088.3594"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="332.5" x="335" y="1142.1924">ObservableReader</text><polygon fill="#A80036" points="1412.5,1199.8828,1437.5,1209.8828,1412.5,1219.8828,1422.5,1209.8828" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="847.5" x2="1427.5" y1="1209.8828" y2="1209.8828"/><rect fill="#EEEEEE" height="7.5" style="stroke: #EEEEEE; stroke-width: 2.5;" width="4176.25" x="0" y="1282.8223"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="1282.8223" y2="1282.8223"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="1290.3223" y2="1290.3223"/><rect fill="#EEEEEE" height="60.8789" style="stroke: #000000; stroke-width: 5.0;" width="367.5" x="1904.375" y="1254.8828"/><text fill="#000000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="322.5" x="1919.375" y="1298.6206">Local CardSelection</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="1467.5" x2="1572.5" y1="1396.6406" y2="1396.6406"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1572.5" x2="1572.5" y1="1396.6406" y2="1429.1406"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1470" x2="1572.5" y1="1429.1406" y2="1429.1406"/><polygon fill="#A80036" points="1495,1419.1406,1470,1429.1406,1495,1439.1406,1485,1429.1406" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="325" x="1485" y="1384.4995">Start Ticketing Service</text><polygon fill="#A80036" points="887.5,1495.0195,862.5,1505.0195,887.5,1515.0195,877.5,1505.0195" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="872.5" x2="1440" y1="1505.0195" y2="1505.0195"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="257.5" x="902.5" y="1492.8784">getReader (name)</text><polygon fill="#A80036" points="1412.5,1570.8984,1437.5,1580.8984,1412.5,1590.8984,1422.5,1580.8984" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="847.5" x2="1427.5" y1="1580.8984" y2="1580.8984"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="90" x="865" y="1568.7573">reader</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="1467.5" x2="1572.5" y1="1656.7773" y2="1656.7773"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1572.5" x2="1572.5" y1="1656.7773" y2="1689.2773"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1470" x2="1572.5" y1="1689.2773" y2="1689.2773"/><polygon fill="#A80036" points="1495,1679.2773,1470,1689.2773,1495,1699.2773,1485,1689.2773" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="430" x="1485" y="1644.6362">prepareCardSelection (reader)</text><polygon fill="#A80036" points="541.25,1755.1563,516.25,1765.1563,541.25,1775.1563,531.25,1765.1563" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="526.25" x2="1440" y1="1765.1563" y2="1765.1563"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="397.5" x="556.25" y="1753.0151">setCardSelectionRequest ()</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="483.75" x2="458.75" y1="1841.0352" y2="1831.0352"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="483.75" x2="458.75" y1="1841.0352" y2="1851.0352"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="118.75" x2="486.25" y1="1841.0352" y2="1841.0352"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="310" x="136.25" y="1828.894">SE_MATCHED Event</text><polygon fill="#A80036" points="146.25,1906.9141,121.25,1916.9141,146.25,1926.9141,136.25,1916.9141" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="131.25" x2="486.25" y1="1916.9141" y2="1916.9141"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="122.5" x="161.25" y="1904.7729">C-APDU</text><polygon fill="#A80036" points="458.75,1982.793,483.75,1992.793,458.75,2002.793,468.75,1992.793" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="118.75" x2="473.75" y1="1992.793" y2="1992.793"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="122.5" x="136.25" y="1980.6519">R-APDU</text><polygon fill="#A80036" points="1412.5,2058.6719,1437.5,2068.6719,1412.5,2078.6719,1422.5,2068.6719" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="501.25" x2="1427.5" y1="2068.6719" y2="2068.6719"/><text fill="#FF0000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="162.5" x="518.75" y="2056.5308">smartCard</text><rect fill="#EEEEEE" height="7.5" style="stroke: #EEEEEE; stroke-width: 2.5;" width="4176.25" x="0" y="2141.6113"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="2141.6113" y2="2141.6113"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="2149.1113" y2="2149.1113"/><rect fill="#EEEEEE" height="60.8789" style="stroke: #000000; stroke-width: 5.0;" width="1060" x="1558.125" y="2113.6719"/><text fill="#000000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="1015" x="1573.125" y="2157.4097">Execute Remote Service for a specific Observable Local Reader</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="1467.5" x2="1572.5" y1="2255.4297" y2="2255.4297"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1572.5" x2="1572.5" y1="2255.4297" y2="2287.9297"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1470" x2="1572.5" y1="2287.9297" y2="2287.9297"/><polygon fill="#A80036" points="1495,2277.9297,1470,2287.9297,1495,2297.9297,1485,2287.9297" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="317.5" x="1485" y="2243.2886">prepare userInputData</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="1467.5" x2="1572.5" y1="2363.8086" y2="2363.8086"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1572.5" x2="1572.5" y1="2363.8086" y2="2396.3086"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1470" x2="1572.5" y1="2396.3086" y2="2396.3086"/><polygon fill="#A80036" points="1495,2386.3086,1470,2396.3086,1495,2406.3086,1485,2396.3086" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="492.5" x="1485" y="2351.6675">LocalClientUtils.getLocalService ()</text><polygon fill="#A80036" points="2135,2666.582,2160,2676.582,2135,2686.582,2145,2676.582" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="1467.5" x2="2150" y1="2676.582" y2="2676.582"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="352.5" x="1485" y="2460.0464">executeRemoteService (</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="385" x="1495" y="2500.9253">RemoteServiceParameters</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="115" x="1515" y="2541.8042">.builder(</text><text fill="#0000FF" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142.5" x="1630" y="2541.8042">serviceId</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="120" x="1772.5" y="2541.8042">, reader)</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="332.5" x="1515" y="2582.6831">.withInitialCardContent(</text><text fill="#FF0000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="162.5" x="1847.5" y="2582.6831">smartCard</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="10" x="2010" y="2582.6831">)</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="282.5" x="1515" y="2623.562">.withUserInputData(</text><text fill="#008000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="220" x="1797.5" y="2623.562">userInputData</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="117.5" x="2017.5" y="2623.562">).build(),</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="352.5" x="1495" y="2664.4409">classOfUserOutputData)</text><polygon fill="#A80036" points="2542.5,2701.582,2567.5,2711.582,2542.5,2721.582,2552.5,2711.582" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="2190" x2="2557.5" y1="2711.582" y2="2711.582"/><polygon fill="#A80036" points="2780,2777.4609,2805,2787.4609,2780,2797.4609,2790,2787.4609" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="2597.5" x2="2795" y1="2787.4609" y2="2787.4609"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="90" x="2615" y="2775.3198">create</text><rect fill="#ADD8E6" height="79.0234" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 3.75;" width="622.5" x="2810" y="2731.582"/><text fill="#000000" font-family="sans-serif" font-size="35" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="587.5" x="2827.5" y="2785.415">ObservableRemoteReaderServer</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="3748.75" x2="3723.75" y1="2893.9844" y2="2883.9844"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3748.75" x2="3723.75" y1="2893.9844" y2="2903.9844"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="2585" x2="3751.25" y1="2893.9844" y2="2893.9844"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="767.5" x="2602.5" y="2881.8433">notify (READER_CONNECTED, remoteReaderName)</text><polygon fill="#A80036" points="2625,2959.8633,2600,2969.8633,2625,2979.8633,2615,2969.8633" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="2610" x2="3751.25" y1="2969.8633" y2="2969.8633"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="465" x="2640" y="2957.7222">getReader (remoteReaderName)</text><polygon fill="#A80036" points="3723.75,3035.7422,3748.75,3045.7422,3723.75,3055.7422,3733.75,3045.7422" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="2585" x2="3738.75" y1="3045.7422" y2="3045.7422"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="202.5" x="2602.5" y="3033.6011">remoteReader</text><polygon fill="#A80036" points="3161.25,3111.6211,3136.25,3121.6211,3161.25,3131.6211,3151.25,3121.6211" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3146.25" x2="3751.25" y1="3121.6211" y2="3121.6211"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="205" x="3176.25" y="3109.48">getServiceId ()</text><polygon fill="#A80036" points="3723.75,3187.5,3748.75,3197.5,3723.75,3207.5,3733.75,3197.5" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="3121.25" x2="3738.75" y1="3197.5" y2="3197.5"/><text fill="#0000FF" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142.5" x="3138.75" y="3185.3589">serviceId</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="3778.75" x2="3883.75" y1="3314.2578" y2="3314.2578"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3883.75" x2="3883.75" y1="3314.2578" y2="3346.7578"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3781.25" x2="3883.75" y1="3346.7578" y2="3346.7578"/><polygon fill="#A80036" points="3806.25,3336.7578,3781.25,3346.7578,3806.25,3356.7578,3796.25,3346.7578" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="305" x="3796.25" y="3261.2378">Find ticketing service</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="190" x="3796.25" y="3302.1167">to start using</text><text fill="#0000FF" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142.5" x="3996.25" y="3302.1167">serviceId</text><rect fill="#EEEEEE" height="7.5" style="stroke: #EEEEEE; stroke-width: 2.5;" width="4176.25" x="0" y="3419.6973"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="3419.6973" y2="3419.6973"/><line style="stroke: #000000; stroke-width: 2.5;" x1="0" x2="4176.25" y1="3427.1973" y2="3427.1973"/><rect fill="#EEEEEE" height="60.8789" style="stroke: #000000; stroke-width: 5.0;" width="452.5" x="1861.875" y="3391.7578"/><text fill="#000000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="407.5" x="1876.875" y="3435.4956">Remote Ticketing Service</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="3778.75" x2="3883.75" y1="3533.5156" y2="3533.5156"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3883.75" x2="3883.75" y1="3533.5156" y2="3566.0156"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3781.25" x2="3883.75" y1="3566.0156" y2="3566.0156"/><polygon fill="#A80036" points="3806.25,3556.0156,3781.25,3566.0156,3806.25,3576.0156,3796.25,3566.0156" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="325" x="3796.25" y="3521.3745">Start Ticketing Service</text><polygon fill="#A80036" points="3161.25,3672.7734,3136.25,3682.7734,3161.25,3692.7734,3151.25,3682.7734" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3146.25" x2="3751.25" y1="3682.7734" y2="3682.7734"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="300" x="3176.25" y="3629.7534">getInitialCardContent</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="285" x="3186.25" y="3670.6323">(classOfSmartCard)</text><polygon fill="#A80036" points="3723.75,3748.6523,3748.75,3758.6523,3723.75,3768.6523,3733.75,3758.6523" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="3121.25" x2="3738.75" y1="3758.6523" y2="3758.6523"/><text fill="#FF0000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="162.5" x="3138.75" y="3746.5112">smartCard</text><polygon fill="#A80036" points="3161.25,3865.4102,3136.25,3875.4102,3161.25,3885.4102,3151.25,3875.4102" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3146.25" x2="3751.25" y1="3875.4102" y2="3875.4102"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="250" x="3176.25" y="3822.3901">getUserInputData</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="335" x="3186.25" y="3863.269">(classOfUserInputData)</text><polygon fill="#A80036" points="3723.75,3941.2891,3748.75,3951.2891,3723.75,3961.2891,3733.75,3951.2891" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="3121.25" x2="3738.75" y1="3951.2891" y2="3951.2891"/><text fill="#008000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="220" x="3138.75" y="3939.1479">userInputData</text><polygon fill="#A80036" points="3161.25,4017.168,3136.25,4027.168,3161.25,4037.168,3151.25,4027.168" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3146.25" x2="3751.25" y1="4027.168" y2="4027.168"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="262.5" x="3176.25" y="4015.0269">addObserver (this)</text><polygon fill="#A80036" points="3723.75,4052.168,3748.75,4062.168,3723.75,4072.168,3733.75,4062.168" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="3121.25" x2="3738.75" y1="4062.168" y2="4062.168"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3778.75" x2="3883.75" y1="4138.0469" y2="4138.0469"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3883.75" x2="3883.75" y1="4138.0469" y2="4170.5469"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3781.25" x2="3883.75" y1="4170.5469" y2="4170.5469"/><polygon fill="#A80036" points="3806.25,4160.5469,3781.25,4170.5469,3806.25,4180.5469,3796.25,4170.5469" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="152.5" x="3796.25" y="4125.9058">continue...</text><path d="M37.5,4208.0469 L207.5,4208.0469 L207.5,4228.0469 L182.5,4253.0469 L25,4253.0469 L25,4220.5469 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 2.5;"/><rect fill="none" height="498.6523" rx="12.5" ry="12.5" style="stroke: #000000; stroke-width: 5.0;" width="4096.25" x="25" y="4208.0469"/><text fill="#000000" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="62.5" y="4244.2847">loop</text><text fill="#000000" font-family="sans-serif" font-size="27.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="242.5" x="245" y="4241.5942">[Card exchanges]</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="3778.75" x2="3883.75" y1="4350.6836" y2="4350.6836"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3883.75" x2="3883.75" y1="4350.6836" y2="4383.1836"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3781.25" x2="3883.75" y1="4383.1836" y2="4383.1836"/><polygon fill="#A80036" points="3806.25,4373.1836,3781.25,4383.1836,3806.25,4393.1836,3796.25,4383.1836" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="295" x="3796.25" y="4297.6636">prepareCardRequest</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="222.5" x="3806.25" y="4338.5425">(remoteReader)</text><polygon fill="#A80036" points="3161.25,4449.0625,3136.25,4459.0625,3161.25,4469.0625,3151.25,4459.0625" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3146.25" x2="3751.25" y1="4459.0625" y2="4459.0625"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="332.5" x="3176.25" y="4446.9214">processCardRequest ()</text><polygon fill="#A80036" points="146.25,4524.9414,121.25,4534.9414,146.25,4544.9414,136.25,4534.9414" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="131.25" x2="3106.25" y1="4534.9414" y2="4534.9414"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="122.5" x="161.25" y="4522.8003">C-APDU</text><polygon fill="#A80036" points="3078.75,4600.8203,3103.75,4610.8203,3078.75,4620.8203,3088.75,4610.8203" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="118.75" x2="3093.75" y1="4610.8203" y2="4610.8203"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="122.5" x="136.25" y="4598.6792">R-APDU</text><polygon fill="#A80036" points="3723.75,4676.6992,3748.75,4686.6992,3723.75,4696.6992,3733.75,4686.6992" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="3121.25" x2="3738.75" y1="4686.6992" y2="4686.6992"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="132.5" x="3138.75" y="4674.5581">response</text><line style="stroke: #A80036; stroke-width: 2.5;" x1="3778.75" x2="3883.75" y1="4780.0781" y2="4780.0781"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3883.75" x2="3883.75" y1="4780.0781" y2="4812.5781"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="3781.25" x2="3883.75" y1="4812.5781" y2="4812.5781"/><polygon fill="#A80036" points="3806.25,4802.5781,3781.25,4812.5781,3806.25,4822.5781,3796.25,4812.5781" style="stroke: #A80036; stroke-width: 2.5;"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="350" x="3796.25" y="4767.937">prepare UserOutputData</text><polygon fill="#A80036" points="2625,4878.457,2600,4888.457,2625,4898.457,2615,4888.457" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="2610" x2="3751.25" y1="4888.457" y2="4888.457"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="557.5" x="2640" y="4876.3159">terminateService (remoteReaderName,</text><text fill="#800080" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="245" x="3207.5" y="4876.3159">userOutputData</text><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="10" x="3452.5" y="4876.3159">)</text><line style="stroke: #A80036; stroke-width: 5.0;" x1="3076.25" x2="3101.25" y1="4951.8359" y2="4976.8359"/><line style="stroke: #A80036; stroke-width: 5.0;" x1="3076.25" x2="3101.25" y1="4976.8359" y2="4951.8359"/><line style="stroke: #A80036; stroke-width: 2.5;" x1="2597.5" x2="3088.75" y1="4964.3359" y2="4964.3359"/><text fill="#000000" font-family="sans-serif" font-size="32.5" lengthAdjust="spacingAndGlyphs" textLength="452.5" x="2615" y="4952.1948">remove remote reader if needed</text><polygon fill="#A80036" points="2217.5,4989.3359,2192.5,4999.3359,2217.5,5009.3359,2207.5,4999.3359" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="2202.5" x2="2582.5" y1="4999.3359" y2="4999.3359"/><polygon fill="#A80036" points="1495,5065.2148,1470,5075.2148,1495,5085.2148,1485,5075.2148" style="stroke: #A80036; stroke-width: 2.5;"/><line style="stroke: #A80036; stroke-width: 2.5; stroke-dasharray: 2.0,2.0;" x1="1480" x2="2175" y1="5075.2148" y2="5075.2148"/><text fill="#800080" font-family="sans-serif" font-size="32.5" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="245" x="1510" y="5063.0737">userOutputData</text><text fill="#888888" font-family="sans-serif" font-size="25" lengthAdjust="spacingAndGlyphs" textLength="987.5" x="1594.375" y="5409.2139">Keyple Distributed - Reader Client Side API with an ObservableReader (05/11/2020)</text><!--MD5=[533f9acc3ac6318eaa62d28cd9d49038]
@startuml
footer
    Keyple Distributed - Reader Client Side API with an ObservableReader (05/11/2020)
end footer

' == THEME ==

skinparam Shadowing false
skinparam RoundCorner 10

'Couleurs issues de : https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/
!define C_LIGHT_YELLOW FEF9E7
!define C_LIGHT_ORANGE FDF2E9

' == CONTENT ==

participant "Card" as se

box "Client APP using Local Lib" #C_LIGHT_YELLOW
participant "**ObservableReader**" as reader #LightBlue
participant "**Plugin**" as plugin #LightBlue
actor "**Ticketing Service**" as client
participant "**LocalServiceClient**" as localService #LightBlue
end box

box "Server APP using Remote Lib" #C_LIGHT_ORANGE
participant "**RemotePluginServer**" as remotePlugin #LightBlue
participant "**ObservableRemoteReaderServer**" as remoteReader #LightBlue
actor "**Remote Ticketing Service**:\n**<back:LightBlue>ObservablePlugin.PluginObserver**" as server
end box

== Remote Lib Initialization ==

activate server #Pink
server -> remotePlugin ** : smartCardService.registerPlugin\n (RemotePluginServerFactory...\n    .withPluginObserver (this)...)
server -> server : Awaiting receipt of\n a Plugin Event...

== Local Lib Initialization ==

activate client #Pink
client -> localService ** : LocalServiceClientFactory...
client -> plugin ** : smartCardService.registerPlugin\n (new XXXFactory())
activate plugin #LightBlue
plugin -> reader ** : create
return

== Local CardSelection ==

client -> client : Start Ticketing Service
client -> plugin : getReader (name)
activate plugin #LightBlue
return reader
client -> client : prepareCardSelection (reader)
client -> reader : setCardSelectionRequest ()
activate reader #LightBlue

activate se #LightYellow
se ->> reader : SE_MATCHED Event
reader -> se : C-APDU
se - -> reader : R-APDU
return <color:red>**smartCard**</color>

== Execute Remote Service for a specific Observable Local Reader ==

client -> client : prepare userInputData

client -> client : LocalClientUtils.getLocalService ()
client -> localService : executeRemoteService (\n RemoteServiceParameters\n   .builder(<color:blue>**serviceId**</color>, reader)\n   .withInitialCardContent(<color:red>**smartCard**</color>)\n   .withUserInputData(<color:green>**userInputData**</color>).build(),\n classOfUserOutputData)
activate localService #LightBlue

localService -> remotePlugin
activate remotePlugin #LightBlue
remotePlugin -> remoteReader ** : create
remotePlugin ->> server : notify (READER_CONNECTED, remoteReaderName)
deactivate remotePlugin

server -> remotePlugin : getReader (remoteReaderName)
activate remotePlugin #LightBlue
return remoteReader
server -> remoteReader : getServiceId ()
activate remoteReader #LightBlue
return <color:blue>**serviceId**</color>
server -> server : Find ticketing service\nto start using <color:blue>**serviceId**</color>

== Remote Ticketing Service ==

server -> server : Start Ticketing Service
server -> remoteReader : getInitialCardContent\n (classOfSmartCard)
activate remoteReader #LightBlue
return <color:red>**smartCard**</color>
server -> remoteReader : getUserInputData\n (classOfUserInputData)
activate remoteReader #LightBlue
return <color:green>**userInputData**</color>
server -> remoteReader : addObserver (this)
activate remoteReader #LightBlue
return
server -> server : continue...

loop #C_LIGHT_ORANGE Card exchanges
    server -> server : prepareCardRequest\n (remoteReader)
    server -> remoteReader : processCardRequest ()
    activate remoteReader #LightBlue
    remoteReader -> se : C-APDU
    se - -> remoteReader : R-APDU
    return response
end loop

server -> server : prepare UserOutputData
server -> remotePlugin : terminateService (remoteReaderName, <color:purple>**userOutputData**</color>)
activate remotePlugin #LightBlue
remotePlugin -x remoteReader : remove remote reader if needed

remotePlugin - -> localService
deactivate remotePlugin
localService - -> client : <color:purple>**userOutputData**</color>
deactivate localService

@enduml

@startuml
footer
    Keyple Distributed - Reader Client Side API with an ObservableReader (05/11/2020)
end footer


skinparam Shadowing false
skinparam RoundCorner 10



participant "Card" as se

box "Client APP using Local Lib" #FEF9E7
participant "**ObservableReader**" as reader #LightBlue
participant "**Plugin**" as plugin #LightBlue
actor "**Ticketing Service**" as client
participant "**LocalServiceClient**" as localService #LightBlue
end box

box "Server APP using Remote Lib" #FDF2E9
participant "**RemotePluginServer**" as remotePlugin #LightBlue
participant "**ObservableRemoteReaderServer**" as remoteReader #LightBlue
actor "**Remote Ticketing Service**:\n**<back:LightBlue>ObservablePlugin.PluginObserver**" as server
end box

== Remote Lib Initialization ==

activate server #Pink
server -> remotePlugin ** : smartCardService.registerPlugin\n (RemotePluginServerFactory...\n    .withPluginObserver (this)...)
server -> server : Awaiting receipt of\n a Plugin Event...

== Local Lib Initialization ==

activate client #Pink
client -> localService ** : LocalServiceClientFactory...
client -> plugin ** : smartCardService.registerPlugin\n (new XXXFactory())
activate plugin #LightBlue
plugin -> reader ** : create
return

== Local CardSelection ==

client -> client : Start Ticketing Service
client -> plugin : getReader (name)
activate plugin #LightBlue
return reader
client -> client : prepareCardSelection (reader)
client -> reader : setCardSelectionRequest ()
activate reader #LightBlue

activate se #LightYellow
se ->> reader : SE_MATCHED Event
reader -> se : C-APDU
se - -> reader : R-APDU
return <color:red>**smartCard**</color>

== Execute Remote Service for a specific Observable Local Reader ==

client -> client : prepare userInputData

client -> client : LocalClientUtils.getLocalService ()
client -> localService : executeRemoteService (\n RemoteServiceParameters\n   .builder(<color:blue>**serviceId**</color>, reader)\n   .withInitialCardContent(<color:red>**smartCard**</color>)\n   .withUserInputData(<color:green>**userInputData**</color>).build(),\n classOfUserOutputData)
activate localService #LightBlue

localService -> remotePlugin
activate remotePlugin #LightBlue
remotePlugin -> remoteReader ** : create
remotePlugin ->> server : notify (READER_CONNECTED, remoteReaderName)
deactivate remotePlugin

server -> remotePlugin : getReader (remoteReaderName)
activate remotePlugin #LightBlue
return remoteReader
server -> remoteReader : getServiceId ()
activate remoteReader #LightBlue
return <color:blue>**serviceId**</color>
server -> server : Find ticketing service\nto start using <color:blue>**serviceId**</color>

== Remote Ticketing Service ==

server -> server : Start Ticketing Service
server -> remoteReader : getInitialCardContent\n (classOfSmartCard)
activate remoteReader #LightBlue
return <color:red>**smartCard**</color>
server -> remoteReader : getUserInputData\n (classOfUserInputData)
activate remoteReader #LightBlue
return <color:green>**userInputData**</color>
server -> remoteReader : addObserver (this)
activate remoteReader #LightBlue
return
server -> server : continue...

loop #FDF2E9 Card exchanges
    server -> server : prepareCardRequest\n (remoteReader)
    server -> remoteReader : processCardRequest ()
    activate remoteReader #LightBlue
    remoteReader -> se : C-APDU
    se - -> remoteReader : R-APDU
    return response
end loop

server -> server : prepare UserOutputData
server -> remotePlugin : terminateService (remoteReaderName, <color:purple>**userOutputData**</color>)
activate remotePlugin #LightBlue
remotePlugin -x remoteReader : remove remote reader if needed

remotePlugin - -> localService
deactivate remotePlugin
localService - -> client : <color:purple>**userOutputData**</color>
deactivate localService

@enduml

PlantUML version 1.2020.20(Sat Nov 21 11:02:45 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>