<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 5.9.6"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=../../../css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=../../../css/wowchemy.713ccde6907aaca544a91a92d40694c3.css><link rel=stylesheet href=../../../css/libs/chroma/github-dark.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=../../../css/libs/chroma/github-dark.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=description content><link rel=alternate hreflang=en-us href=https://keyple.org/user-guides/non-keyple-client/selection-json-specification/><link rel=canonical href=https://keyple.org/user-guides/non-keyple-client/selection-json-specification/><link rel=manifest href=../../../manifest.webmanifest><link rel=icon type=image/png href=../../../media/icon_hu16db34b3636b127457de39ca2fab620f_9845_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=../../../media/icon_hu16db34b3636b127457de39ca2fab620f_9845_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1D87BB"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://keyple.org/media/logo.svg"><meta property="og:type" content="website"><meta property="og:site_name" content="Eclipse Keyple"><meta property="og:url" content="https://keyple.org/user-guides/non-keyple-client/selection-json-specification/"><meta property="og:title" content="Selection JSON Specification (for non-Keyple client) | Eclipse Keyple"><meta property="og:description" content><meta property="og:image" content="https://keyple.org/media/logo.svg"><meta property="og:locale" content="en-us"><link rel=alternate href=../../../user-guides/non-keyple-client/selection-json-specification/index.xml type=application/rss+xml title="Eclipse Keyple"><title>Selection JSON Specification (for non-Keyple client) | Eclipse Keyple</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=8c92695831586392780025f9ae6a78ba><script src=../../../js/wowchemy-init.min.d66af272089c6c0601f1a57edc3bf6ab.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=../../../><img src=../../../media/logo.svg alt="Eclipse Keyple"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=../../../><img src=../../../media/logo.svg alt="Eclipse Keyple"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>What is Eclipse Keyple®</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=../../../what-is-keyple/overview/><span>Overview</span></a>
<a class=dropdown-item href=../../../what-is-keyple/why-trust/><span>Why trust Eclipse Keyple®?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/who-is-it-for/><span>Who is it for?</span></a>
<a class=dropdown-item href=../../../#adopters><span>Who is using Eclipse Keyple®?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/what-is-calypso/><span>What is Calypso®?</span></a>
<a class=dropdown-item href=../../../what-is-keyple/main-features/><span>Keyple's main features</span></a>
<a class=dropdown-item href=../../../#news><span>News</span></a></div></li><li class=nav-item><a class=nav-link href=../../../learn/overview><span>Learn</span></a></li><li class=nav-item><a class=nav-link href=../../../components/overview><span>Components</span></a></li><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>Community</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=../../../adopters-and-testimonials/><span>Adopters & Testimonials</span></a>
<a class=dropdown-item href=../../../community/contributing/><span>Contributing</span></a>
<a class=dropdown-item href=../../../community/roadmap/><span>Roadmap</span></a>
<a class=dropdown-item href=../../../community/changelog/><span>Changelog</span></a>
<a class=dropdown-item href=../../../project-dashboard/><span>Project dashboard</span></a>
<a class=dropdown-item href=../../../statistics/><span>Statistics</span></a>
<a class=dropdown-item href="https://sonarcloud.io/organizations/eclipse/projects?search=keyple&amp;sort=-analysis_date"><span>Code quality dashboard</span></a>
<a class=dropdown-item href=https://projects.eclipse.org/projects/iot.keyple/><span>Eclipse Foundation Keyple page</span></a>
<a class=dropdown-item href=https://accounts.eclipse.org/mailing-list/keyple-dev/><span>Mailing list</span></a>
<a class=dropdown-item href=https://github.com/eclipse-keyple/><span>GitHub home repository</span></a>
<a class=dropdown-item href=https://docs.keyple.org/><span>All APIs docs</span></a></div></li><li class=nav-item><a class=nav-link href=../../../external-resources/><span>External resources</span></a></li><li class=nav-item><a class=nav-link href=../../../learn/build-your-first-app/><button class='btn btn-info'><i class='fas fa-rocket pr-1' aria-hidden=true></i> <span>START CODING</span></button></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav></header></div><div class=page-body><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden"></span><span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>Search...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li><a href=../../../user-guides/></a></li><div class=docs-toc-item><a class=docs-toc-link href=../../../user-guides/non-keyple-client/></a><ul class="nav docs-sidenav"><div class=docs-toc-item><a class=docs-toc-link href=../../../user-guides/non-keyple-client/back-to-user-guides/>🢤 Back to user guides</a></div><div class=docs-toc-item><a class=docs-toc-link href=../../../user-guides/non-keyple-client/overview/>Non-Keyple client</a></div><div class=docs-toc-item><a class=docs-toc-link href=../../../user-guides/non-keyple-client/server-json-api/>Server JSON API</a><ul class="nav docs-sidenav"><li><a href=../../../user-guides/non-keyple-client/server-json-api/2-1/>Version 2.1</a></li><li><a href=../../../user-guides/non-keyple-client/server-json-api/2-0/>Version 2.0</a></li><li><a href=../../../user-guides/non-keyple-client/server-json-api/1-0/>Version 1.0</a></li></ul></div><div class=docs-toc-item><a class="docs-toc-link active" href=../../../user-guides/non-keyple-client/selection-json-specification/>Selection JSON Specification</a><ul class="nav docs-sidenav"><li><a href=../../../user-guides/non-keyple-client/selection-json-specification/1-0/>Version 1.0</a></li></ul></div></ul></div></ul></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#workflow>Workflow</a></li><li><a href=#selection-processing>Selection processing</a></li><li><a href=#selection-result-processing>Selection result processing</a></li><li><a href=#json-specification>JSON specification</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><div class=docs-article-container></div><div class=docs-article-container><h1>Selection JSON Specification (for non-Keyple client)</h1><article class=article-style><br><p>The <strong>Selection JSON Specification</strong> describes how to implement early card selection on the terminal before requesting
the server to continue the card transaction, as well as the JSON format of the involved data.</p><div class="alert alert-warning"><div>Implementing early card selection is <strong>strongly recommended</strong> for non-Keyple clients as it <strong>increases performance</strong> by
reducing the number of network exchanges, as the selection scenario can be processed autonomously by the terminal as
soon as a card is presented.</div></div><br><h2 id=workflow>Workflow</h2><p>This specification is based on Keyple&rsquo;s
&ldquo;<a href=https://keyple.org/learn/user-guide/standalone-application/#importexport-a-scenario>Import/Export Scenario</a>&rdquo;
functionality, which enables to import/export prepared and processed card selection scenarios,
and therefore follows the same workflow.</p><p>The early card selection involves two JSON strings exchanged between the terminal and the server:</p><table><thead><tr><th>JSON</th><th style=text-align:center>Direction</th><th>Description</th></tr></thead><tbody><tr><td><code>CardSelectionScenarioJsonString</code></td><td style=text-align:center>From server</td><td>A JSON string containing the exported card selection scenario.</td></tr><tr><td><code>ProcessedCardSelectionScenarioJsonString</code></td><td style=text-align:center>To server</td><td>A JSON string containing the result of the processed card selection scenario.</td></tr></tbody></table><p>On its own initiative (e.g. at startup), the terminal requests the server to export the card selection scenario to be
processed when a card is detected. The server returns a JSON string <code>CardSelectionScenarioJsonString</code> containing the
scenario.</p><p>Later, when a card is detected, the terminal processes the scenario on the card.</p><p>Then, it generates a JSON string <code>ProcessedCardSelectionScenarioJsonString</code> containing the result of the
processed scenario, and sends it to the server using the <a href=../../../user-guides/non-keyple-client/server-json-api/>Server JSON API</a>
to continue the transaction.</p><p>The diagram below illustrates the workflow:</p><figure id=figure-keyple-selection-json-specification---workflow><div class="d-flex justify-content-center"><div class=w-100><img src=../../../media/learn/user-guide/non-keyple-client/selection-json-specification-common/Sequence_SelectionJsonSpecification.svg alt="Keyple Selection JSON Specification - Workflow" loading=lazy data-zoomable></div></div><figcaption>Keyple Selection JSON Specification - Workflow</figcaption></figure><br><h2 id=selection-processing>Selection processing</h2><p>The primary objective of selection step is to establish a logical communication channel with a card.</p><p>To enable processing of different card profiles, Keyple offers the creation of selection scenarios with integrated
selection cases. The scenario is provided by the server, and it involves checking whether the
card is compatible with at least one of the selection cases. The selection cases are processed successively, in the
order in which they are defined.</p><p>There are several options for executing the scenario:</p><ul><li>the process stops at the first selection case where the card matches, or all selection cases are systematically processed.</li><li>the physical channel can be kept open or closed at the end of each selection case.</li></ul><p>A card selection case incorporates various independent filters that can be applied individually or in combination
to determine if a detected card is suitable for performing a transaction. While some cards can be selected based on
communication protocol or response data from the power-on operation, most of the cards require a selection through
Application Identifier (AID) using the ISO7816-4 &ldquo;Select Application&rdquo; APDU command.</p><p>The structure outlined below allows for defining selection scenarios that combine these three types of filters:</p><ul><li>based on the communication protocol,</li><li>based on the response data from the power on stage,</li><li>based on the Application Identifier (AID).</li></ul><p>When filtering by AID, the &ldquo;Select Application&rdquo; APDU command is sent to the card in accordance with the ISO7816-4
standard.
Additional parameters, also defined by the standard, can be set to specify the type of operation (<code>FileOccurrence</code>)
and the type of output (<code>FileControlInformation</code>).</p><p>Each filter is optional, and if none are defined, the selection is considered successful as soon as the card is
detected.
However, when a filter is specified, it becomes a prerequisite for the card selection.</p><p>In addition to card selection, a selection scenario can include a list of APDUs that are to be transmitted to the card
as soon as it becomes &ldquo;selected&rdquo;.</p><p>The terminal must iterate over each selection cases of the scenario, determine which type of filter to apply and apply
it (e.g. protocol, power-on data, AID).</p><p>If all the defined filters are satisfied, the terminal must send any additional APDUs.</p><br><h2 id=selection-result-processing>Selection result processing</h2><p>The JSON string <code>ProcessedCardSelectionScenarioJsonString</code> resulting from the processed card selection scenario
must be transmitted to the server in the <code>inputData</code> property of the “<strong>Execute Remote Service</strong>” message
of the <a href=../../../user-guides/non-keyple-client/server-json-api/>Server JSON API</a>.</p><div class="alert alert-note"><div>The JSON string can be wrapped inside a parent object if other
information needs to be transmitted to the server.</div></div><br><h2 id=json-specification>JSON specification</h2><ul class=list-unstyled><li><h5><a href=../../../user-guides/non-keyple-client/selection-json-specification/1-0/>Version 1.0</a></h5></li></ul></article><div class=article-widget><div class=post-nav></div></div></div><div class=body-footer><p>Last updated on 2025-03-06</p></div><footer class=site-footer><div class=container><div class="row featurette"><div class="col-12 col-sm-4"><p style=color:#fff><b>ECLIPSE LEGAL</b></p><a href=https://www.eclipse.org/legal/privacy.php>Privacy Policy</a><br><a href=https://www.eclipse.org/legal/termsofuse.php>Terms of Use</a><br><a href=https://www.eclipse.org/legal/copyright.php>Copyright Agent</a><br><a href=https://www.eclipse.org/legal/epl-2.0/>Eclipse Public License</a><br><a href=https://www.eclipse.org/legal/>Legal Resources</a><br><a href=https://eclipse.org/security/ target=_blank>Report a Vulnerability</a><br></div><div class="col-12 col-sm-4"><a href=https://www.eclipse.org target=_blank><img src=../../../media/eclipse_foundation_logo.svg id=logo-eclipse-foundation></a></div><div class="col-12 col-sm-4"><a href=https://iot.eclipse.org target=_blank><img src=../../../media/eclipse_iot_logo.svg id=logo-eclipse-iot></a></div></div></div><p class="powered-by copyright-license-text">© 2019-2025 The Eclipse Keyple® project. All Rights Reserved.</p><p class=powered-by id=template-info>Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target=_blank rel=noopener>Hugo Blox Builder</a> — the free, <a href=https://github.com/HugoBlox/hugo-blox-builder target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></main></div></div></div><div class=page-footer></div><script src=../../../js/vendor-bundle.min.938a3a7554cd9f6602290411f64d2617.js></script><script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js integrity="sha256-aQmOEF2ZD4NM/xt4hthzREIo/2PFkOX/g01WjxEV7Ys=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script><script id=page-data type=application/json>{"use_headroom":false}</script><script src=../../../en/js/wowchemy.min.452865b1d834bc61c53be56b7f191e42.js></script><script src=../../../js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script><link rel=stylesheet href=https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap4.min.css><script src=https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js></script><script src=https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js></script><script src=https://d3js.org/d3.v6.min.js></script></body></html>